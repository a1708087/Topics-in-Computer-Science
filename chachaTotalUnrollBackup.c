/*
chacha-ref.c version 20080118
D. J. Bernstein
Public domain.
*/
#include <stdio.h>

#include "ecrypt-sync.h"

#define ROTATE(v,c) (ROTL32(v,c))
#define XOR(v,w) ((v) ^ (w))
#define PLUS(v,w) (U32V((v) + (w)))
#define PLUSONE(v) (PLUS((v),1))

#define QUARTERROUND(a,b,c,d) \
  x[a] = PLUS(x[a],x[b]); x[d] = ROTATE(XOR(x[d],x[a]),16); \
  x[c] = PLUS(x[c],x[d]); x[b] = ROTATE(XOR(x[b],x[c]),12); \
  x[a] = PLUS(x[a],x[b]); x[d] = ROTATE(XOR(x[d],x[a]), 8); \
  x[c] = PLUS(x[c],x[d]); x[b] = ROTATE(XOR(x[b],x[c]), 7);

static void salsa20_wordtobyte(u8 output[64],const u32 input[16])
{
  u32 x[16];
  int i;

  for (i = 0;i < 16;++i) x[i] = input[i];
  for (i = 8;i > 0;i -= 2) {
    QUARTERROUND( 0, 4, 8,12)
    QUARTERROUND( 1, 5, 9,13)
    QUARTERROUND( 2, 6,10,14)
    QUARTERROUND( 3, 7,11,15)
    QUARTERROUND( 0, 5,10,15)
    QUARTERROUND( 1, 6,11,12)
    QUARTERROUND( 2, 7, 8,13)
    QUARTERROUND( 3, 4, 9,14)
  }
  for (i = 0;i < 16;++i) x[i] = PLUS(x[i],input[i]);
  for (i = 0;i < 16;++i) U32TO8_LITTLE(output + 4 * i,x[i]);
}

void ECRYPT_init(void)
{
  return;
}

static const char sigma[16] = "expand 32-byte k";
static const char tau[16] = "expand 16-byte k";

void ECRYPT_keysetup(ECRYPT_ctx *x,const u8 *k,u32 kbits,u32 ivbits)
{
  const char *constants;

  //***Key row 1 (2nd row of matrix)
  x->input[4] = U8TO32_LITTLE(k + 0);
  x->input[5] = U8TO32_LITTLE(k + 4);
  x->input[6] = U8TO32_LITTLE(k + 8);
  x->input[7] = U8TO32_LITTLE(k + 12);
  if (kbits == 256) { /* recommended */
    k += 16;
    constants = sigma;
  } else { /* kbits == 128 */
    constants = tau;
  }
  //***Key row 2 (3rd row of matrix)
  x->input[8] = U8TO32_LITTLE(k + 0);
  x->input[9] = U8TO32_LITTLE(k + 4);
  x->input[10] = U8TO32_LITTLE(k + 8);
  x->input[11] = U8TO32_LITTLE(k + 12);
  //***Constant row (1st row of matrix)
  x->input[0] = U8TO32_LITTLE(constants + 0);
  x->input[1] = U8TO32_LITTLE(constants + 4);
  x->input[2] = U8TO32_LITTLE(constants + 8);
  x->input[3] = U8TO32_LITTLE(constants + 12);
}

void ECRYPT_ivsetup(ECRYPT_ctx *x,const u8 *iv)
{
  //***4th row of matrix
  //***Block counter
  x->input[12] = 0;
  x->input[13] = 0;
  //***NONCE
  x->input[14] = U8TO32_LITTLE(iv + 0);
  x->input[15] = U8TO32_LITTLE(iv + 4);
}

void ECRYPT_encrypt_bytes(ECRYPT_ctx *x,const u8 *m,u8 *c,u32 bytes)
{
  u8 output[64];
  int i;
  if (!bytes) return;
  for (;;) {
    //***conducts the quarter rounds, then adds original and new matrices. output is now the keystream
    salsa20_wordtobyte(output,x->input);
    x->input[12] = PLUSONE(x->input[12]);
    if (!x->input[12]) {
      x->input[13] = PLUSONE(x->input[13]);
      /* stopping at 2^70 bytes per nonce is user's responsibility */
    }

    //***XORS the keystream with the message (plaintext) to form the ciphertext
    //***loops back to the top of the for loop until <= 64 bytes left (last block)
    if (bytes <= 64) {
      for (i = 0;i < bytes;++i) c[i] = m[i] ^ output[i];
      //***Print how many blocks were mixed
      //printf("Blocks:%d\n", x->input[12] + x->input[13]);
      return;
    }
    for (i = 0;i < 64;++i) c[i] = m[i] ^ output[i];
    bytes -= 64;
    c += 64;
    m += 64;
  }
}

void ECRYPT_decrypt_bytes(ECRYPT_ctx *x,const u8 *c,u8 *m,u32 bytes)
{
  ECRYPT_encrypt_bytes(x,c,m,bytes);
}

void ECRYPT_keystream_bytes(ECRYPT_ctx *x,u8 *stream,u32 bytes)
{
  //**
  u32 i;
  for (i = 0;i < bytes;++i) stream[i] = 0;
  ECRYPT_encrypt_bytes(x,stream,stream,bytes);
}

//************************************************************************
//below is main gathered from https://stackoverflow.com/questions/11176998/how-to-use-salsa20-or-chacha

#include <stdio.h>
#include <stdint.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include "ecrypt-sync.h"

//***This is how big the message is (bytes)
#define CHUNKSIZE 1024

void showData(u8 *data, u8 *header);
static inline uint64_t rdtscp64();

int main(int argc, char** argv)
{
    char plaintext[CHUNKSIZE] = "DO IT, just DO IT! Don’t let your dreams be dreams. Yesterday, you said tomorrow. So just. DO IT! Make. your dreams. COME TRUE! Just… do it! Some people dream of success, while you’re gonna wake up and work HARD at it! NOTHING IS IMPOSSIBLE!You should get to the point where anyone else would quit, and you’re not gonna stop there. NO! What are you waiting for? … DO IT! Just… DO IT! Yes you can! Just do it! If you’re tired of starting over, stop. giving. up.";
    ECRYPT_ctx ctx;
    u8 *key, *IV, *ciphertext, *result;

    showData(plaintext, "PLAINTEXT");

    key = (u8 *)calloc((size_t)ECRYPT_MAXKEYSIZE/8, sizeof(u8));
    IV = (u8 *)calloc((size_t)ECRYPT_MAXIVSIZE/8, sizeof(u8));

    //***Produce a random Key
    ECRYPT_keystream_bytes(&ctx, key, (size_t)ECRYPT_MAXKEYSIZE/8 * sizeof(u8));
    //***produce a manual key
    //key = "This is a key";

    showData(key, "KEY");
    showData(IV, "IV");

    printf("Encrypting [%s] using random %d bit key and %d bit IV:\n", plaintext, ECRYPT_MAXKEYSIZE, ECRYPT_MAXIVSIZE);

    //**repeat and gather averages for time taken
      ECRYPT_init();
      ECRYPT_keysetup(&ctx, key, ECRYPT_MAXKEYSIZE, ECRYPT_MAXIVSIZE);
      ECRYPT_ivsetup(&ctx, IV);

      ciphertext = (u8 *)calloc((size_t)CHUNKSIZE, sizeof(u8));

      //***The chacha ciphering. Produces a ciphertext.
      //***collect the time before and after
      uint64_t startT = rdtscp64();

u8 output[64];
u32 x[16];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
ciphertext[0] = plaintext[0] ^ output[0];
ciphertext[1] = plaintext[1] ^ output[1];
ciphertext[2] = plaintext[2] ^ output[2];
ciphertext[3] = plaintext[3] ^ output[3];
ciphertext[4] = plaintext[4] ^ output[4];
ciphertext[5] = plaintext[5] ^ output[5];
ciphertext[6] = plaintext[6] ^ output[6];
ciphertext[7] = plaintext[7] ^ output[7];
ciphertext[8] = plaintext[8] ^ output[8];
ciphertext[9] = plaintext[9] ^ output[9];
ciphertext[10] = plaintext[10] ^ output[10];
ciphertext[11] = plaintext[11] ^ output[11];
ciphertext[12] = plaintext[12] ^ output[12];
ciphertext[13] = plaintext[13] ^ output[13];
ciphertext[14] = plaintext[14] ^ output[14];
ciphertext[15] = plaintext[15] ^ output[15];
ciphertext[16] = plaintext[16] ^ output[16];
ciphertext[17] = plaintext[17] ^ output[17];
ciphertext[18] = plaintext[18] ^ output[18];
ciphertext[19] = plaintext[19] ^ output[19];
ciphertext[20] = plaintext[20] ^ output[20];
ciphertext[21] = plaintext[21] ^ output[21];
ciphertext[22] = plaintext[22] ^ output[22];
ciphertext[23] = plaintext[23] ^ output[23];
ciphertext[24] = plaintext[24] ^ output[24];
ciphertext[25] = plaintext[25] ^ output[25];
ciphertext[26] = plaintext[26] ^ output[26];
ciphertext[27] = plaintext[27] ^ output[27];
ciphertext[28] = plaintext[28] ^ output[28];
ciphertext[29] = plaintext[29] ^ output[29];
ciphertext[30] = plaintext[30] ^ output[30];
ciphertext[31] = plaintext[31] ^ output[31];
ciphertext[32] = plaintext[32] ^ output[32];
ciphertext[33] = plaintext[33] ^ output[33];
ciphertext[34] = plaintext[34] ^ output[34];
ciphertext[35] = plaintext[35] ^ output[35];
ciphertext[36] = plaintext[36] ^ output[36];
ciphertext[37] = plaintext[37] ^ output[37];
ciphertext[38] = plaintext[38] ^ output[38];
ciphertext[39] = plaintext[39] ^ output[39];
ciphertext[40] = plaintext[40] ^ output[40];
ciphertext[41] = plaintext[41] ^ output[41];
ciphertext[42] = plaintext[42] ^ output[42];
ciphertext[43] = plaintext[43] ^ output[43];
ciphertext[44] = plaintext[44] ^ output[44];
ciphertext[45] = plaintext[45] ^ output[45];
ciphertext[46] = plaintext[46] ^ output[46];
ciphertext[47] = plaintext[47] ^ output[47];
ciphertext[48] = plaintext[48] ^ output[48];
ciphertext[49] = plaintext[49] ^ output[49];
ciphertext[50] = plaintext[50] ^ output[50];
ciphertext[51] = plaintext[51] ^ output[51];
ciphertext[52] = plaintext[52] ^ output[52];
ciphertext[53] = plaintext[53] ^ output[53];
ciphertext[54] = plaintext[54] ^ output[54];
ciphertext[55] = plaintext[55] ^ output[55];
ciphertext[56] = plaintext[56] ^ output[56];
ciphertext[57] = plaintext[57] ^ output[57];
ciphertext[58] = plaintext[58] ^ output[58];
ciphertext[59] = plaintext[59] ^ output[59];
ciphertext[60] = plaintext[60] ^ output[60];
ciphertext[61] = plaintext[61] ^ output[61];
ciphertext[62] = plaintext[62] ^ output[62];
ciphertext[63] = plaintext[63] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
ciphertext[64] = plaintext[64] ^ output[0];
ciphertext[65] = plaintext[65] ^ output[1];
ciphertext[66] = plaintext[66] ^ output[2];
ciphertext[67] = plaintext[67] ^ output[3];
ciphertext[68] = plaintext[68] ^ output[4];
ciphertext[69] = plaintext[69] ^ output[5];
ciphertext[70] = plaintext[70] ^ output[6];
ciphertext[71] = plaintext[71] ^ output[7];
ciphertext[72] = plaintext[72] ^ output[8];
ciphertext[73] = plaintext[73] ^ output[9];
ciphertext[74] = plaintext[74] ^ output[10];
ciphertext[75] = plaintext[75] ^ output[11];
ciphertext[76] = plaintext[76] ^ output[12];
ciphertext[77] = plaintext[77] ^ output[13];
ciphertext[78] = plaintext[78] ^ output[14];
ciphertext[79] = plaintext[79] ^ output[15];
ciphertext[80] = plaintext[80] ^ output[16];
ciphertext[81] = plaintext[81] ^ output[17];
ciphertext[82] = plaintext[82] ^ output[18];
ciphertext[83] = plaintext[83] ^ output[19];
ciphertext[84] = plaintext[84] ^ output[20];
ciphertext[85] = plaintext[85] ^ output[21];
ciphertext[86] = plaintext[86] ^ output[22];
ciphertext[87] = plaintext[87] ^ output[23];
ciphertext[88] = plaintext[88] ^ output[24];
ciphertext[89] = plaintext[89] ^ output[25];
ciphertext[90] = plaintext[90] ^ output[26];
ciphertext[91] = plaintext[91] ^ output[27];
ciphertext[92] = plaintext[92] ^ output[28];
ciphertext[93] = plaintext[93] ^ output[29];
ciphertext[94] = plaintext[94] ^ output[30];
ciphertext[95] = plaintext[95] ^ output[31];
ciphertext[96] = plaintext[96] ^ output[32];
ciphertext[97] = plaintext[97] ^ output[33];
ciphertext[98] = plaintext[98] ^ output[34];
ciphertext[99] = plaintext[99] ^ output[35];
ciphertext[100] = plaintext[100] ^ output[36];
ciphertext[101] = plaintext[101] ^ output[37];
ciphertext[102] = plaintext[102] ^ output[38];
ciphertext[103] = plaintext[103] ^ output[39];
ciphertext[104] = plaintext[104] ^ output[40];
ciphertext[105] = plaintext[105] ^ output[41];
ciphertext[106] = plaintext[106] ^ output[42];
ciphertext[107] = plaintext[107] ^ output[43];
ciphertext[108] = plaintext[108] ^ output[44];
ciphertext[109] = plaintext[109] ^ output[45];
ciphertext[110] = plaintext[110] ^ output[46];
ciphertext[111] = plaintext[111] ^ output[47];
ciphertext[112] = plaintext[112] ^ output[48];
ciphertext[113] = plaintext[113] ^ output[49];
ciphertext[114] = plaintext[114] ^ output[50];
ciphertext[115] = plaintext[115] ^ output[51];
ciphertext[116] = plaintext[116] ^ output[52];
ciphertext[117] = plaintext[117] ^ output[53];
ciphertext[118] = plaintext[118] ^ output[54];
ciphertext[119] = plaintext[119] ^ output[55];
ciphertext[120] = plaintext[120] ^ output[56];
ciphertext[121] = plaintext[121] ^ output[57];
ciphertext[122] = plaintext[122] ^ output[58];
ciphertext[123] = plaintext[123] ^ output[59];
ciphertext[124] = plaintext[124] ^ output[60];
ciphertext[125] = plaintext[125] ^ output[61];
ciphertext[126] = plaintext[126] ^ output[62];
ciphertext[127] = plaintext[127] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
ciphertext[128] = plaintext[128] ^ output[0];
ciphertext[129] = plaintext[129] ^ output[1];
ciphertext[130] = plaintext[130] ^ output[2];
ciphertext[131] = plaintext[131] ^ output[3];
ciphertext[132] = plaintext[132] ^ output[4];
ciphertext[133] = plaintext[133] ^ output[5];
ciphertext[134] = plaintext[134] ^ output[6];
ciphertext[135] = plaintext[135] ^ output[7];
ciphertext[136] = plaintext[136] ^ output[8];
ciphertext[137] = plaintext[137] ^ output[9];
ciphertext[138] = plaintext[138] ^ output[10];
ciphertext[139] = plaintext[139] ^ output[11];
ciphertext[140] = plaintext[140] ^ output[12];
ciphertext[141] = plaintext[141] ^ output[13];
ciphertext[142] = plaintext[142] ^ output[14];
ciphertext[143] = plaintext[143] ^ output[15];
ciphertext[144] = plaintext[144] ^ output[16];
ciphertext[145] = plaintext[145] ^ output[17];
ciphertext[146] = plaintext[146] ^ output[18];
ciphertext[147] = plaintext[147] ^ output[19];
ciphertext[148] = plaintext[148] ^ output[20];
ciphertext[149] = plaintext[149] ^ output[21];
ciphertext[150] = plaintext[150] ^ output[22];
ciphertext[151] = plaintext[151] ^ output[23];
ciphertext[152] = plaintext[152] ^ output[24];
ciphertext[153] = plaintext[153] ^ output[25];
ciphertext[154] = plaintext[154] ^ output[26];
ciphertext[155] = plaintext[155] ^ output[27];
ciphertext[156] = plaintext[156] ^ output[28];
ciphertext[157] = plaintext[157] ^ output[29];
ciphertext[158] = plaintext[158] ^ output[30];
ciphertext[159] = plaintext[159] ^ output[31];
ciphertext[160] = plaintext[160] ^ output[32];
ciphertext[161] = plaintext[161] ^ output[33];
ciphertext[162] = plaintext[162] ^ output[34];
ciphertext[163] = plaintext[163] ^ output[35];
ciphertext[164] = plaintext[164] ^ output[36];
ciphertext[165] = plaintext[165] ^ output[37];
ciphertext[166] = plaintext[166] ^ output[38];
ciphertext[167] = plaintext[167] ^ output[39];
ciphertext[168] = plaintext[168] ^ output[40];
ciphertext[169] = plaintext[169] ^ output[41];
ciphertext[170] = plaintext[170] ^ output[42];
ciphertext[171] = plaintext[171] ^ output[43];
ciphertext[172] = plaintext[172] ^ output[44];
ciphertext[173] = plaintext[173] ^ output[45];
ciphertext[174] = plaintext[174] ^ output[46];
ciphertext[175] = plaintext[175] ^ output[47];
ciphertext[176] = plaintext[176] ^ output[48];
ciphertext[177] = plaintext[177] ^ output[49];
ciphertext[178] = plaintext[178] ^ output[50];
ciphertext[179] = plaintext[179] ^ output[51];
ciphertext[180] = plaintext[180] ^ output[52];
ciphertext[181] = plaintext[181] ^ output[53];
ciphertext[182] = plaintext[182] ^ output[54];
ciphertext[183] = plaintext[183] ^ output[55];
ciphertext[184] = plaintext[184] ^ output[56];
ciphertext[185] = plaintext[185] ^ output[57];
ciphertext[186] = plaintext[186] ^ output[58];
ciphertext[187] = plaintext[187] ^ output[59];
ciphertext[188] = plaintext[188] ^ output[60];
ciphertext[189] = plaintext[189] ^ output[61];
ciphertext[190] = plaintext[190] ^ output[62];
ciphertext[191] = plaintext[191] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
ciphertext[192] = plaintext[192] ^ output[0];
ciphertext[193] = plaintext[193] ^ output[1];
ciphertext[194] = plaintext[194] ^ output[2];
ciphertext[195] = plaintext[195] ^ output[3];
ciphertext[196] = plaintext[196] ^ output[4];
ciphertext[197] = plaintext[197] ^ output[5];
ciphertext[198] = plaintext[198] ^ output[6];
ciphertext[199] = plaintext[199] ^ output[7];
ciphertext[200] = plaintext[200] ^ output[8];
ciphertext[201] = plaintext[201] ^ output[9];
ciphertext[202] = plaintext[202] ^ output[10];
ciphertext[203] = plaintext[203] ^ output[11];
ciphertext[204] = plaintext[204] ^ output[12];
ciphertext[205] = plaintext[205] ^ output[13];
ciphertext[206] = plaintext[206] ^ output[14];
ciphertext[207] = plaintext[207] ^ output[15];
ciphertext[208] = plaintext[208] ^ output[16];
ciphertext[209] = plaintext[209] ^ output[17];
ciphertext[210] = plaintext[210] ^ output[18];
ciphertext[211] = plaintext[211] ^ output[19];
ciphertext[212] = plaintext[212] ^ output[20];
ciphertext[213] = plaintext[213] ^ output[21];
ciphertext[214] = plaintext[214] ^ output[22];
ciphertext[215] = plaintext[215] ^ output[23];
ciphertext[216] = plaintext[216] ^ output[24];
ciphertext[217] = plaintext[217] ^ output[25];
ciphertext[218] = plaintext[218] ^ output[26];
ciphertext[219] = plaintext[219] ^ output[27];
ciphertext[220] = plaintext[220] ^ output[28];
ciphertext[221] = plaintext[221] ^ output[29];
ciphertext[222] = plaintext[222] ^ output[30];
ciphertext[223] = plaintext[223] ^ output[31];
ciphertext[224] = plaintext[224] ^ output[32];
ciphertext[225] = plaintext[225] ^ output[33];
ciphertext[226] = plaintext[226] ^ output[34];
ciphertext[227] = plaintext[227] ^ output[35];
ciphertext[228] = plaintext[228] ^ output[36];
ciphertext[229] = plaintext[229] ^ output[37];
ciphertext[230] = plaintext[230] ^ output[38];
ciphertext[231] = plaintext[231] ^ output[39];
ciphertext[232] = plaintext[232] ^ output[40];
ciphertext[233] = plaintext[233] ^ output[41];
ciphertext[234] = plaintext[234] ^ output[42];
ciphertext[235] = plaintext[235] ^ output[43];
ciphertext[236] = plaintext[236] ^ output[44];
ciphertext[237] = plaintext[237] ^ output[45];
ciphertext[238] = plaintext[238] ^ output[46];
ciphertext[239] = plaintext[239] ^ output[47];
ciphertext[240] = plaintext[240] ^ output[48];
ciphertext[241] = plaintext[241] ^ output[49];
ciphertext[242] = plaintext[242] ^ output[50];
ciphertext[243] = plaintext[243] ^ output[51];
ciphertext[244] = plaintext[244] ^ output[52];
ciphertext[245] = plaintext[245] ^ output[53];
ciphertext[246] = plaintext[246] ^ output[54];
ciphertext[247] = plaintext[247] ^ output[55];
ciphertext[248] = plaintext[248] ^ output[56];
ciphertext[249] = plaintext[249] ^ output[57];
ciphertext[250] = plaintext[250] ^ output[58];
ciphertext[251] = plaintext[251] ^ output[59];
ciphertext[252] = plaintext[252] ^ output[60];
ciphertext[253] = plaintext[253] ^ output[61];
ciphertext[254] = plaintext[254] ^ output[62];
ciphertext[255] = plaintext[255] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
ciphertext[256] = plaintext[256] ^ output[0];
ciphertext[257] = plaintext[257] ^ output[1];
ciphertext[258] = plaintext[258] ^ output[2];
ciphertext[259] = plaintext[259] ^ output[3];
ciphertext[260] = plaintext[260] ^ output[4];
ciphertext[261] = plaintext[261] ^ output[5];
ciphertext[262] = plaintext[262] ^ output[6];
ciphertext[263] = plaintext[263] ^ output[7];
ciphertext[264] = plaintext[264] ^ output[8];
ciphertext[265] = plaintext[265] ^ output[9];
ciphertext[266] = plaintext[266] ^ output[10];
ciphertext[267] = plaintext[267] ^ output[11];
ciphertext[268] = plaintext[268] ^ output[12];
ciphertext[269] = plaintext[269] ^ output[13];
ciphertext[270] = plaintext[270] ^ output[14];
ciphertext[271] = plaintext[271] ^ output[15];
ciphertext[272] = plaintext[272] ^ output[16];
ciphertext[273] = plaintext[273] ^ output[17];
ciphertext[274] = plaintext[274] ^ output[18];
ciphertext[275] = plaintext[275] ^ output[19];
ciphertext[276] = plaintext[276] ^ output[20];
ciphertext[277] = plaintext[277] ^ output[21];
ciphertext[278] = plaintext[278] ^ output[22];
ciphertext[279] = plaintext[279] ^ output[23];
ciphertext[280] = plaintext[280] ^ output[24];
ciphertext[281] = plaintext[281] ^ output[25];
ciphertext[282] = plaintext[282] ^ output[26];
ciphertext[283] = plaintext[283] ^ output[27];
ciphertext[284] = plaintext[284] ^ output[28];
ciphertext[285] = plaintext[285] ^ output[29];
ciphertext[286] = plaintext[286] ^ output[30];
ciphertext[287] = plaintext[287] ^ output[31];
ciphertext[288] = plaintext[288] ^ output[32];
ciphertext[289] = plaintext[289] ^ output[33];
ciphertext[290] = plaintext[290] ^ output[34];
ciphertext[291] = plaintext[291] ^ output[35];
ciphertext[292] = plaintext[292] ^ output[36];
ciphertext[293] = plaintext[293] ^ output[37];
ciphertext[294] = plaintext[294] ^ output[38];
ciphertext[295] = plaintext[295] ^ output[39];
ciphertext[296] = plaintext[296] ^ output[40];
ciphertext[297] = plaintext[297] ^ output[41];
ciphertext[298] = plaintext[298] ^ output[42];
ciphertext[299] = plaintext[299] ^ output[43];
ciphertext[300] = plaintext[300] ^ output[44];
ciphertext[301] = plaintext[301] ^ output[45];
ciphertext[302] = plaintext[302] ^ output[46];
ciphertext[303] = plaintext[303] ^ output[47];
ciphertext[304] = plaintext[304] ^ output[48];
ciphertext[305] = plaintext[305] ^ output[49];
ciphertext[306] = plaintext[306] ^ output[50];
ciphertext[307] = plaintext[307] ^ output[51];
ciphertext[308] = plaintext[308] ^ output[52];
ciphertext[309] = plaintext[309] ^ output[53];
ciphertext[310] = plaintext[310] ^ output[54];
ciphertext[311] = plaintext[311] ^ output[55];
ciphertext[312] = plaintext[312] ^ output[56];
ciphertext[313] = plaintext[313] ^ output[57];
ciphertext[314] = plaintext[314] ^ output[58];
ciphertext[315] = plaintext[315] ^ output[59];
ciphertext[316] = plaintext[316] ^ output[60];
ciphertext[317] = plaintext[317] ^ output[61];
ciphertext[318] = plaintext[318] ^ output[62];
ciphertext[319] = plaintext[319] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
ciphertext[320] = plaintext[320] ^ output[0];
ciphertext[321] = plaintext[321] ^ output[1];
ciphertext[322] = plaintext[322] ^ output[2];
ciphertext[323] = plaintext[323] ^ output[3];
ciphertext[324] = plaintext[324] ^ output[4];
ciphertext[325] = plaintext[325] ^ output[5];
ciphertext[326] = plaintext[326] ^ output[6];
ciphertext[327] = plaintext[327] ^ output[7];
ciphertext[328] = plaintext[328] ^ output[8];
ciphertext[329] = plaintext[329] ^ output[9];
ciphertext[330] = plaintext[330] ^ output[10];
ciphertext[331] = plaintext[331] ^ output[11];
ciphertext[332] = plaintext[332] ^ output[12];
ciphertext[333] = plaintext[333] ^ output[13];
ciphertext[334] = plaintext[334] ^ output[14];
ciphertext[335] = plaintext[335] ^ output[15];
ciphertext[336] = plaintext[336] ^ output[16];
ciphertext[337] = plaintext[337] ^ output[17];
ciphertext[338] = plaintext[338] ^ output[18];
ciphertext[339] = plaintext[339] ^ output[19];
ciphertext[340] = plaintext[340] ^ output[20];
ciphertext[341] = plaintext[341] ^ output[21];
ciphertext[342] = plaintext[342] ^ output[22];
ciphertext[343] = plaintext[343] ^ output[23];
ciphertext[344] = plaintext[344] ^ output[24];
ciphertext[345] = plaintext[345] ^ output[25];
ciphertext[346] = plaintext[346] ^ output[26];
ciphertext[347] = plaintext[347] ^ output[27];
ciphertext[348] = plaintext[348] ^ output[28];
ciphertext[349] = plaintext[349] ^ output[29];
ciphertext[350] = plaintext[350] ^ output[30];
ciphertext[351] = plaintext[351] ^ output[31];
ciphertext[352] = plaintext[352] ^ output[32];
ciphertext[353] = plaintext[353] ^ output[33];
ciphertext[354] = plaintext[354] ^ output[34];
ciphertext[355] = plaintext[355] ^ output[35];
ciphertext[356] = plaintext[356] ^ output[36];
ciphertext[357] = plaintext[357] ^ output[37];
ciphertext[358] = plaintext[358] ^ output[38];
ciphertext[359] = plaintext[359] ^ output[39];
ciphertext[360] = plaintext[360] ^ output[40];
ciphertext[361] = plaintext[361] ^ output[41];
ciphertext[362] = plaintext[362] ^ output[42];
ciphertext[363] = plaintext[363] ^ output[43];
ciphertext[364] = plaintext[364] ^ output[44];
ciphertext[365] = plaintext[365] ^ output[45];
ciphertext[366] = plaintext[366] ^ output[46];
ciphertext[367] = plaintext[367] ^ output[47];
ciphertext[368] = plaintext[368] ^ output[48];
ciphertext[369] = plaintext[369] ^ output[49];
ciphertext[370] = plaintext[370] ^ output[50];
ciphertext[371] = plaintext[371] ^ output[51];
ciphertext[372] = plaintext[372] ^ output[52];
ciphertext[373] = plaintext[373] ^ output[53];
ciphertext[374] = plaintext[374] ^ output[54];
ciphertext[375] = plaintext[375] ^ output[55];
ciphertext[376] = plaintext[376] ^ output[56];
ciphertext[377] = plaintext[377] ^ output[57];
ciphertext[378] = plaintext[378] ^ output[58];
ciphertext[379] = plaintext[379] ^ output[59];
ciphertext[380] = plaintext[380] ^ output[60];
ciphertext[381] = plaintext[381] ^ output[61];
ciphertext[382] = plaintext[382] ^ output[62];
ciphertext[383] = plaintext[383] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
ciphertext[384] = plaintext[384] ^ output[0];
ciphertext[385] = plaintext[385] ^ output[1];
ciphertext[386] = plaintext[386] ^ output[2];
ciphertext[387] = plaintext[387] ^ output[3];
ciphertext[388] = plaintext[388] ^ output[4];
ciphertext[389] = plaintext[389] ^ output[5];
ciphertext[390] = plaintext[390] ^ output[6];
ciphertext[391] = plaintext[391] ^ output[7];
ciphertext[392] = plaintext[392] ^ output[8];
ciphertext[393] = plaintext[393] ^ output[9];
ciphertext[394] = plaintext[394] ^ output[10];
ciphertext[395] = plaintext[395] ^ output[11];
ciphertext[396] = plaintext[396] ^ output[12];
ciphertext[397] = plaintext[397] ^ output[13];
ciphertext[398] = plaintext[398] ^ output[14];
ciphertext[399] = plaintext[399] ^ output[15];
ciphertext[400] = plaintext[400] ^ output[16];
ciphertext[401] = plaintext[401] ^ output[17];
ciphertext[402] = plaintext[402] ^ output[18];
ciphertext[403] = plaintext[403] ^ output[19];
ciphertext[404] = plaintext[404] ^ output[20];
ciphertext[405] = plaintext[405] ^ output[21];
ciphertext[406] = plaintext[406] ^ output[22];
ciphertext[407] = plaintext[407] ^ output[23];
ciphertext[408] = plaintext[408] ^ output[24];
ciphertext[409] = plaintext[409] ^ output[25];
ciphertext[410] = plaintext[410] ^ output[26];
ciphertext[411] = plaintext[411] ^ output[27];
ciphertext[412] = plaintext[412] ^ output[28];
ciphertext[413] = plaintext[413] ^ output[29];
ciphertext[414] = plaintext[414] ^ output[30];
ciphertext[415] = plaintext[415] ^ output[31];
ciphertext[416] = plaintext[416] ^ output[32];
ciphertext[417] = plaintext[417] ^ output[33];
ciphertext[418] = plaintext[418] ^ output[34];
ciphertext[419] = plaintext[419] ^ output[35];
ciphertext[420] = plaintext[420] ^ output[36];
ciphertext[421] = plaintext[421] ^ output[37];
ciphertext[422] = plaintext[422] ^ output[38];
ciphertext[423] = plaintext[423] ^ output[39];
ciphertext[424] = plaintext[424] ^ output[40];
ciphertext[425] = plaintext[425] ^ output[41];
ciphertext[426] = plaintext[426] ^ output[42];
ciphertext[427] = plaintext[427] ^ output[43];
ciphertext[428] = plaintext[428] ^ output[44];
ciphertext[429] = plaintext[429] ^ output[45];
ciphertext[430] = plaintext[430] ^ output[46];
ciphertext[431] = plaintext[431] ^ output[47];
ciphertext[432] = plaintext[432] ^ output[48];
ciphertext[433] = plaintext[433] ^ output[49];
ciphertext[434] = plaintext[434] ^ output[50];
ciphertext[435] = plaintext[435] ^ output[51];
ciphertext[436] = plaintext[436] ^ output[52];
ciphertext[437] = plaintext[437] ^ output[53];
ciphertext[438] = plaintext[438] ^ output[54];
ciphertext[439] = plaintext[439] ^ output[55];
ciphertext[440] = plaintext[440] ^ output[56];
ciphertext[441] = plaintext[441] ^ output[57];
ciphertext[442] = plaintext[442] ^ output[58];
ciphertext[443] = plaintext[443] ^ output[59];
ciphertext[444] = plaintext[444] ^ output[60];
ciphertext[445] = plaintext[445] ^ output[61];
ciphertext[446] = plaintext[446] ^ output[62];
ciphertext[447] = plaintext[447] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
ciphertext[448] = plaintext[448] ^ output[0];
ciphertext[449] = plaintext[449] ^ output[1];
ciphertext[450] = plaintext[450] ^ output[2];
ciphertext[451] = plaintext[451] ^ output[3];
ciphertext[452] = plaintext[452] ^ output[4];
ciphertext[453] = plaintext[453] ^ output[5];
ciphertext[454] = plaintext[454] ^ output[6];
ciphertext[455] = plaintext[455] ^ output[7];
ciphertext[456] = plaintext[456] ^ output[8];
ciphertext[457] = plaintext[457] ^ output[9];
ciphertext[458] = plaintext[458] ^ output[10];
ciphertext[459] = plaintext[459] ^ output[11];
ciphertext[460] = plaintext[460] ^ output[12];
ciphertext[461] = plaintext[461] ^ output[13];
ciphertext[462] = plaintext[462] ^ output[14];
ciphertext[463] = plaintext[463] ^ output[15];
ciphertext[464] = plaintext[464] ^ output[16];
ciphertext[465] = plaintext[465] ^ output[17];
ciphertext[466] = plaintext[466] ^ output[18];
ciphertext[467] = plaintext[467] ^ output[19];
ciphertext[468] = plaintext[468] ^ output[20];
ciphertext[469] = plaintext[469] ^ output[21];
ciphertext[470] = plaintext[470] ^ output[22];
ciphertext[471] = plaintext[471] ^ output[23];
ciphertext[472] = plaintext[472] ^ output[24];
ciphertext[473] = plaintext[473] ^ output[25];
ciphertext[474] = plaintext[474] ^ output[26];
ciphertext[475] = plaintext[475] ^ output[27];
ciphertext[476] = plaintext[476] ^ output[28];
ciphertext[477] = plaintext[477] ^ output[29];
ciphertext[478] = plaintext[478] ^ output[30];
ciphertext[479] = plaintext[479] ^ output[31];
ciphertext[480] = plaintext[480] ^ output[32];
ciphertext[481] = plaintext[481] ^ output[33];
ciphertext[482] = plaintext[482] ^ output[34];
ciphertext[483] = plaintext[483] ^ output[35];
ciphertext[484] = plaintext[484] ^ output[36];
ciphertext[485] = plaintext[485] ^ output[37];
ciphertext[486] = plaintext[486] ^ output[38];
ciphertext[487] = plaintext[487] ^ output[39];
ciphertext[488] = plaintext[488] ^ output[40];
ciphertext[489] = plaintext[489] ^ output[41];
ciphertext[490] = plaintext[490] ^ output[42];
ciphertext[491] = plaintext[491] ^ output[43];
ciphertext[492] = plaintext[492] ^ output[44];
ciphertext[493] = plaintext[493] ^ output[45];
ciphertext[494] = plaintext[494] ^ output[46];
ciphertext[495] = plaintext[495] ^ output[47];
ciphertext[496] = plaintext[496] ^ output[48];
ciphertext[497] = plaintext[497] ^ output[49];
ciphertext[498] = plaintext[498] ^ output[50];
ciphertext[499] = plaintext[499] ^ output[51];
ciphertext[500] = plaintext[500] ^ output[52];
ciphertext[501] = plaintext[501] ^ output[53];
ciphertext[502] = plaintext[502] ^ output[54];
ciphertext[503] = plaintext[503] ^ output[55];
ciphertext[504] = plaintext[504] ^ output[56];
ciphertext[505] = plaintext[505] ^ output[57];
ciphertext[506] = plaintext[506] ^ output[58];
ciphertext[507] = plaintext[507] ^ output[59];
ciphertext[508] = plaintext[508] ^ output[60];
ciphertext[509] = plaintext[509] ^ output[61];
ciphertext[510] = plaintext[510] ^ output[62];
ciphertext[511] = plaintext[511] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
ciphertext[512] = plaintext[512] ^ output[0];
ciphertext[513] = plaintext[513] ^ output[1];
ciphertext[514] = plaintext[514] ^ output[2];
ciphertext[515] = plaintext[515] ^ output[3];
ciphertext[516] = plaintext[516] ^ output[4];
ciphertext[517] = plaintext[517] ^ output[5];
ciphertext[518] = plaintext[518] ^ output[6];
ciphertext[519] = plaintext[519] ^ output[7];
ciphertext[520] = plaintext[520] ^ output[8];
ciphertext[521] = plaintext[521] ^ output[9];
ciphertext[522] = plaintext[522] ^ output[10];
ciphertext[523] = plaintext[523] ^ output[11];
ciphertext[524] = plaintext[524] ^ output[12];
ciphertext[525] = plaintext[525] ^ output[13];
ciphertext[526] = plaintext[526] ^ output[14];
ciphertext[527] = plaintext[527] ^ output[15];
ciphertext[528] = plaintext[528] ^ output[16];
ciphertext[529] = plaintext[529] ^ output[17];
ciphertext[530] = plaintext[530] ^ output[18];
ciphertext[531] = plaintext[531] ^ output[19];
ciphertext[532] = plaintext[532] ^ output[20];
ciphertext[533] = plaintext[533] ^ output[21];
ciphertext[534] = plaintext[534] ^ output[22];
ciphertext[535] = plaintext[535] ^ output[23];
ciphertext[536] = plaintext[536] ^ output[24];
ciphertext[537] = plaintext[537] ^ output[25];
ciphertext[538] = plaintext[538] ^ output[26];
ciphertext[539] = plaintext[539] ^ output[27];
ciphertext[540] = plaintext[540] ^ output[28];
ciphertext[541] = plaintext[541] ^ output[29];
ciphertext[542] = plaintext[542] ^ output[30];
ciphertext[543] = plaintext[543] ^ output[31];
ciphertext[544] = plaintext[544] ^ output[32];
ciphertext[545] = plaintext[545] ^ output[33];
ciphertext[546] = plaintext[546] ^ output[34];
ciphertext[547] = plaintext[547] ^ output[35];
ciphertext[548] = plaintext[548] ^ output[36];
ciphertext[549] = plaintext[549] ^ output[37];
ciphertext[550] = plaintext[550] ^ output[38];
ciphertext[551] = plaintext[551] ^ output[39];
ciphertext[552] = plaintext[552] ^ output[40];
ciphertext[553] = plaintext[553] ^ output[41];
ciphertext[554] = plaintext[554] ^ output[42];
ciphertext[555] = plaintext[555] ^ output[43];
ciphertext[556] = plaintext[556] ^ output[44];
ciphertext[557] = plaintext[557] ^ output[45];
ciphertext[558] = plaintext[558] ^ output[46];
ciphertext[559] = plaintext[559] ^ output[47];
ciphertext[560] = plaintext[560] ^ output[48];
ciphertext[561] = plaintext[561] ^ output[49];
ciphertext[562] = plaintext[562] ^ output[50];
ciphertext[563] = plaintext[563] ^ output[51];
ciphertext[564] = plaintext[564] ^ output[52];
ciphertext[565] = plaintext[565] ^ output[53];
ciphertext[566] = plaintext[566] ^ output[54];
ciphertext[567] = plaintext[567] ^ output[55];
ciphertext[568] = plaintext[568] ^ output[56];
ciphertext[569] = plaintext[569] ^ output[57];
ciphertext[570] = plaintext[570] ^ output[58];
ciphertext[571] = plaintext[571] ^ output[59];
ciphertext[572] = plaintext[572] ^ output[60];
ciphertext[573] = plaintext[573] ^ output[61];
ciphertext[574] = plaintext[574] ^ output[62];
ciphertext[575] = plaintext[575] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
ciphertext[576] = plaintext[576] ^ output[0];
ciphertext[577] = plaintext[577] ^ output[1];
ciphertext[578] = plaintext[578] ^ output[2];
ciphertext[579] = plaintext[579] ^ output[3];
ciphertext[580] = plaintext[580] ^ output[4];
ciphertext[581] = plaintext[581] ^ output[5];
ciphertext[582] = plaintext[582] ^ output[6];
ciphertext[583] = plaintext[583] ^ output[7];
ciphertext[584] = plaintext[584] ^ output[8];
ciphertext[585] = plaintext[585] ^ output[9];
ciphertext[586] = plaintext[586] ^ output[10];
ciphertext[587] = plaintext[587] ^ output[11];
ciphertext[588] = plaintext[588] ^ output[12];
ciphertext[589] = plaintext[589] ^ output[13];
ciphertext[590] = plaintext[590] ^ output[14];
ciphertext[591] = plaintext[591] ^ output[15];
ciphertext[592] = plaintext[592] ^ output[16];
ciphertext[593] = plaintext[593] ^ output[17];
ciphertext[594] = plaintext[594] ^ output[18];
ciphertext[595] = plaintext[595] ^ output[19];
ciphertext[596] = plaintext[596] ^ output[20];
ciphertext[597] = plaintext[597] ^ output[21];
ciphertext[598] = plaintext[598] ^ output[22];
ciphertext[599] = plaintext[599] ^ output[23];
ciphertext[600] = plaintext[600] ^ output[24];
ciphertext[601] = plaintext[601] ^ output[25];
ciphertext[602] = plaintext[602] ^ output[26];
ciphertext[603] = plaintext[603] ^ output[27];
ciphertext[604] = plaintext[604] ^ output[28];
ciphertext[605] = plaintext[605] ^ output[29];
ciphertext[606] = plaintext[606] ^ output[30];
ciphertext[607] = plaintext[607] ^ output[31];
ciphertext[608] = plaintext[608] ^ output[32];
ciphertext[609] = plaintext[609] ^ output[33];
ciphertext[610] = plaintext[610] ^ output[34];
ciphertext[611] = plaintext[611] ^ output[35];
ciphertext[612] = plaintext[612] ^ output[36];
ciphertext[613] = plaintext[613] ^ output[37];
ciphertext[614] = plaintext[614] ^ output[38];
ciphertext[615] = plaintext[615] ^ output[39];
ciphertext[616] = plaintext[616] ^ output[40];
ciphertext[617] = plaintext[617] ^ output[41];
ciphertext[618] = plaintext[618] ^ output[42];
ciphertext[619] = plaintext[619] ^ output[43];
ciphertext[620] = plaintext[620] ^ output[44];
ciphertext[621] = plaintext[621] ^ output[45];
ciphertext[622] = plaintext[622] ^ output[46];
ciphertext[623] = plaintext[623] ^ output[47];
ciphertext[624] = plaintext[624] ^ output[48];
ciphertext[625] = plaintext[625] ^ output[49];
ciphertext[626] = plaintext[626] ^ output[50];
ciphertext[627] = plaintext[627] ^ output[51];
ciphertext[628] = plaintext[628] ^ output[52];
ciphertext[629] = plaintext[629] ^ output[53];
ciphertext[630] = plaintext[630] ^ output[54];
ciphertext[631] = plaintext[631] ^ output[55];
ciphertext[632] = plaintext[632] ^ output[56];
ciphertext[633] = plaintext[633] ^ output[57];
ciphertext[634] = plaintext[634] ^ output[58];
ciphertext[635] = plaintext[635] ^ output[59];
ciphertext[636] = plaintext[636] ^ output[60];
ciphertext[637] = plaintext[637] ^ output[61];
ciphertext[638] = plaintext[638] ^ output[62];
ciphertext[639] = plaintext[639] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
ciphertext[640] = plaintext[640] ^ output[0];
ciphertext[641] = plaintext[641] ^ output[1];
ciphertext[642] = plaintext[642] ^ output[2];
ciphertext[643] = plaintext[643] ^ output[3];
ciphertext[644] = plaintext[644] ^ output[4];
ciphertext[645] = plaintext[645] ^ output[5];
ciphertext[646] = plaintext[646] ^ output[6];
ciphertext[647] = plaintext[647] ^ output[7];
ciphertext[648] = plaintext[648] ^ output[8];
ciphertext[649] = plaintext[649] ^ output[9];
ciphertext[650] = plaintext[650] ^ output[10];
ciphertext[651] = plaintext[651] ^ output[11];
ciphertext[652] = plaintext[652] ^ output[12];
ciphertext[653] = plaintext[653] ^ output[13];
ciphertext[654] = plaintext[654] ^ output[14];
ciphertext[655] = plaintext[655] ^ output[15];
ciphertext[656] = plaintext[656] ^ output[16];
ciphertext[657] = plaintext[657] ^ output[17];
ciphertext[658] = plaintext[658] ^ output[18];
ciphertext[659] = plaintext[659] ^ output[19];
ciphertext[660] = plaintext[660] ^ output[20];
ciphertext[661] = plaintext[661] ^ output[21];
ciphertext[662] = plaintext[662] ^ output[22];
ciphertext[663] = plaintext[663] ^ output[23];
ciphertext[664] = plaintext[664] ^ output[24];
ciphertext[665] = plaintext[665] ^ output[25];
ciphertext[666] = plaintext[666] ^ output[26];
ciphertext[667] = plaintext[667] ^ output[27];
ciphertext[668] = plaintext[668] ^ output[28];
ciphertext[669] = plaintext[669] ^ output[29];
ciphertext[670] = plaintext[670] ^ output[30];
ciphertext[671] = plaintext[671] ^ output[31];
ciphertext[672] = plaintext[672] ^ output[32];
ciphertext[673] = plaintext[673] ^ output[33];
ciphertext[674] = plaintext[674] ^ output[34];
ciphertext[675] = plaintext[675] ^ output[35];
ciphertext[676] = plaintext[676] ^ output[36];
ciphertext[677] = plaintext[677] ^ output[37];
ciphertext[678] = plaintext[678] ^ output[38];
ciphertext[679] = plaintext[679] ^ output[39];
ciphertext[680] = plaintext[680] ^ output[40];
ciphertext[681] = plaintext[681] ^ output[41];
ciphertext[682] = plaintext[682] ^ output[42];
ciphertext[683] = plaintext[683] ^ output[43];
ciphertext[684] = plaintext[684] ^ output[44];
ciphertext[685] = plaintext[685] ^ output[45];
ciphertext[686] = plaintext[686] ^ output[46];
ciphertext[687] = plaintext[687] ^ output[47];
ciphertext[688] = plaintext[688] ^ output[48];
ciphertext[689] = plaintext[689] ^ output[49];
ciphertext[690] = plaintext[690] ^ output[50];
ciphertext[691] = plaintext[691] ^ output[51];
ciphertext[692] = plaintext[692] ^ output[52];
ciphertext[693] = plaintext[693] ^ output[53];
ciphertext[694] = plaintext[694] ^ output[54];
ciphertext[695] = plaintext[695] ^ output[55];
ciphertext[696] = plaintext[696] ^ output[56];
ciphertext[697] = plaintext[697] ^ output[57];
ciphertext[698] = plaintext[698] ^ output[58];
ciphertext[699] = plaintext[699] ^ output[59];
ciphertext[700] = plaintext[700] ^ output[60];
ciphertext[701] = plaintext[701] ^ output[61];
ciphertext[702] = plaintext[702] ^ output[62];
ciphertext[703] = plaintext[703] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
ciphertext[704] = plaintext[704] ^ output[0];
ciphertext[705] = plaintext[705] ^ output[1];
ciphertext[706] = plaintext[706] ^ output[2];
ciphertext[707] = plaintext[707] ^ output[3];
ciphertext[708] = plaintext[708] ^ output[4];
ciphertext[709] = plaintext[709] ^ output[5];
ciphertext[710] = plaintext[710] ^ output[6];
ciphertext[711] = plaintext[711] ^ output[7];
ciphertext[712] = plaintext[712] ^ output[8];
ciphertext[713] = plaintext[713] ^ output[9];
ciphertext[714] = plaintext[714] ^ output[10];
ciphertext[715] = plaintext[715] ^ output[11];
ciphertext[716] = plaintext[716] ^ output[12];
ciphertext[717] = plaintext[717] ^ output[13];
ciphertext[718] = plaintext[718] ^ output[14];
ciphertext[719] = plaintext[719] ^ output[15];
ciphertext[720] = plaintext[720] ^ output[16];
ciphertext[721] = plaintext[721] ^ output[17];
ciphertext[722] = plaintext[722] ^ output[18];
ciphertext[723] = plaintext[723] ^ output[19];
ciphertext[724] = plaintext[724] ^ output[20];
ciphertext[725] = plaintext[725] ^ output[21];
ciphertext[726] = plaintext[726] ^ output[22];
ciphertext[727] = plaintext[727] ^ output[23];
ciphertext[728] = plaintext[728] ^ output[24];
ciphertext[729] = plaintext[729] ^ output[25];
ciphertext[730] = plaintext[730] ^ output[26];
ciphertext[731] = plaintext[731] ^ output[27];
ciphertext[732] = plaintext[732] ^ output[28];
ciphertext[733] = plaintext[733] ^ output[29];
ciphertext[734] = plaintext[734] ^ output[30];
ciphertext[735] = plaintext[735] ^ output[31];
ciphertext[736] = plaintext[736] ^ output[32];
ciphertext[737] = plaintext[737] ^ output[33];
ciphertext[738] = plaintext[738] ^ output[34];
ciphertext[739] = plaintext[739] ^ output[35];
ciphertext[740] = plaintext[740] ^ output[36];
ciphertext[741] = plaintext[741] ^ output[37];
ciphertext[742] = plaintext[742] ^ output[38];
ciphertext[743] = plaintext[743] ^ output[39];
ciphertext[744] = plaintext[744] ^ output[40];
ciphertext[745] = plaintext[745] ^ output[41];
ciphertext[746] = plaintext[746] ^ output[42];
ciphertext[747] = plaintext[747] ^ output[43];
ciphertext[748] = plaintext[748] ^ output[44];
ciphertext[749] = plaintext[749] ^ output[45];
ciphertext[750] = plaintext[750] ^ output[46];
ciphertext[751] = plaintext[751] ^ output[47];
ciphertext[752] = plaintext[752] ^ output[48];
ciphertext[753] = plaintext[753] ^ output[49];
ciphertext[754] = plaintext[754] ^ output[50];
ciphertext[755] = plaintext[755] ^ output[51];
ciphertext[756] = plaintext[756] ^ output[52];
ciphertext[757] = plaintext[757] ^ output[53];
ciphertext[758] = plaintext[758] ^ output[54];
ciphertext[759] = plaintext[759] ^ output[55];
ciphertext[760] = plaintext[760] ^ output[56];
ciphertext[761] = plaintext[761] ^ output[57];
ciphertext[762] = plaintext[762] ^ output[58];
ciphertext[763] = plaintext[763] ^ output[59];
ciphertext[764] = plaintext[764] ^ output[60];
ciphertext[765] = plaintext[765] ^ output[61];
ciphertext[766] = plaintext[766] ^ output[62];
ciphertext[767] = plaintext[767] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
ciphertext[768] = plaintext[768] ^ output[0];
ciphertext[769] = plaintext[769] ^ output[1];
ciphertext[770] = plaintext[770] ^ output[2];
ciphertext[771] = plaintext[771] ^ output[3];
ciphertext[772] = plaintext[772] ^ output[4];
ciphertext[773] = plaintext[773] ^ output[5];
ciphertext[774] = plaintext[774] ^ output[6];
ciphertext[775] = plaintext[775] ^ output[7];
ciphertext[776] = plaintext[776] ^ output[8];
ciphertext[777] = plaintext[777] ^ output[9];
ciphertext[778] = plaintext[778] ^ output[10];
ciphertext[779] = plaintext[779] ^ output[11];
ciphertext[780] = plaintext[780] ^ output[12];
ciphertext[781] = plaintext[781] ^ output[13];
ciphertext[782] = plaintext[782] ^ output[14];
ciphertext[783] = plaintext[783] ^ output[15];
ciphertext[784] = plaintext[784] ^ output[16];
ciphertext[785] = plaintext[785] ^ output[17];
ciphertext[786] = plaintext[786] ^ output[18];
ciphertext[787] = plaintext[787] ^ output[19];
ciphertext[788] = plaintext[788] ^ output[20];
ciphertext[789] = plaintext[789] ^ output[21];
ciphertext[790] = plaintext[790] ^ output[22];
ciphertext[791] = plaintext[791] ^ output[23];
ciphertext[792] = plaintext[792] ^ output[24];
ciphertext[793] = plaintext[793] ^ output[25];
ciphertext[794] = plaintext[794] ^ output[26];
ciphertext[795] = plaintext[795] ^ output[27];
ciphertext[796] = plaintext[796] ^ output[28];
ciphertext[797] = plaintext[797] ^ output[29];
ciphertext[798] = plaintext[798] ^ output[30];
ciphertext[799] = plaintext[799] ^ output[31];
ciphertext[800] = plaintext[800] ^ output[32];
ciphertext[801] = plaintext[801] ^ output[33];
ciphertext[802] = plaintext[802] ^ output[34];
ciphertext[803] = plaintext[803] ^ output[35];
ciphertext[804] = plaintext[804] ^ output[36];
ciphertext[805] = plaintext[805] ^ output[37];
ciphertext[806] = plaintext[806] ^ output[38];
ciphertext[807] = plaintext[807] ^ output[39];
ciphertext[808] = plaintext[808] ^ output[40];
ciphertext[809] = plaintext[809] ^ output[41];
ciphertext[810] = plaintext[810] ^ output[42];
ciphertext[811] = plaintext[811] ^ output[43];
ciphertext[812] = plaintext[812] ^ output[44];
ciphertext[813] = plaintext[813] ^ output[45];
ciphertext[814] = plaintext[814] ^ output[46];
ciphertext[815] = plaintext[815] ^ output[47];
ciphertext[816] = plaintext[816] ^ output[48];
ciphertext[817] = plaintext[817] ^ output[49];
ciphertext[818] = plaintext[818] ^ output[50];
ciphertext[819] = plaintext[819] ^ output[51];
ciphertext[820] = plaintext[820] ^ output[52];
ciphertext[821] = plaintext[821] ^ output[53];
ciphertext[822] = plaintext[822] ^ output[54];
ciphertext[823] = plaintext[823] ^ output[55];
ciphertext[824] = plaintext[824] ^ output[56];
ciphertext[825] = plaintext[825] ^ output[57];
ciphertext[826] = plaintext[826] ^ output[58];
ciphertext[827] = plaintext[827] ^ output[59];
ciphertext[828] = plaintext[828] ^ output[60];
ciphertext[829] = plaintext[829] ^ output[61];
ciphertext[830] = plaintext[830] ^ output[62];
ciphertext[831] = plaintext[831] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
ciphertext[832] = plaintext[832] ^ output[0];
ciphertext[833] = plaintext[833] ^ output[1];
ciphertext[834] = plaintext[834] ^ output[2];
ciphertext[835] = plaintext[835] ^ output[3];
ciphertext[836] = plaintext[836] ^ output[4];
ciphertext[837] = plaintext[837] ^ output[5];
ciphertext[838] = plaintext[838] ^ output[6];
ciphertext[839] = plaintext[839] ^ output[7];
ciphertext[840] = plaintext[840] ^ output[8];
ciphertext[841] = plaintext[841] ^ output[9];
ciphertext[842] = plaintext[842] ^ output[10];
ciphertext[843] = plaintext[843] ^ output[11];
ciphertext[844] = plaintext[844] ^ output[12];
ciphertext[845] = plaintext[845] ^ output[13];
ciphertext[846] = plaintext[846] ^ output[14];
ciphertext[847] = plaintext[847] ^ output[15];
ciphertext[848] = plaintext[848] ^ output[16];
ciphertext[849] = plaintext[849] ^ output[17];
ciphertext[850] = plaintext[850] ^ output[18];
ciphertext[851] = plaintext[851] ^ output[19];
ciphertext[852] = plaintext[852] ^ output[20];
ciphertext[853] = plaintext[853] ^ output[21];
ciphertext[854] = plaintext[854] ^ output[22];
ciphertext[855] = plaintext[855] ^ output[23];
ciphertext[856] = plaintext[856] ^ output[24];
ciphertext[857] = plaintext[857] ^ output[25];
ciphertext[858] = plaintext[858] ^ output[26];
ciphertext[859] = plaintext[859] ^ output[27];
ciphertext[860] = plaintext[860] ^ output[28];
ciphertext[861] = plaintext[861] ^ output[29];
ciphertext[862] = plaintext[862] ^ output[30];
ciphertext[863] = plaintext[863] ^ output[31];
ciphertext[864] = plaintext[864] ^ output[32];
ciphertext[865] = plaintext[865] ^ output[33];
ciphertext[866] = plaintext[866] ^ output[34];
ciphertext[867] = plaintext[867] ^ output[35];
ciphertext[868] = plaintext[868] ^ output[36];
ciphertext[869] = plaintext[869] ^ output[37];
ciphertext[870] = plaintext[870] ^ output[38];
ciphertext[871] = plaintext[871] ^ output[39];
ciphertext[872] = plaintext[872] ^ output[40];
ciphertext[873] = plaintext[873] ^ output[41];
ciphertext[874] = plaintext[874] ^ output[42];
ciphertext[875] = plaintext[875] ^ output[43];
ciphertext[876] = plaintext[876] ^ output[44];
ciphertext[877] = plaintext[877] ^ output[45];
ciphertext[878] = plaintext[878] ^ output[46];
ciphertext[879] = plaintext[879] ^ output[47];
ciphertext[880] = plaintext[880] ^ output[48];
ciphertext[881] = plaintext[881] ^ output[49];
ciphertext[882] = plaintext[882] ^ output[50];
ciphertext[883] = plaintext[883] ^ output[51];
ciphertext[884] = plaintext[884] ^ output[52];
ciphertext[885] = plaintext[885] ^ output[53];
ciphertext[886] = plaintext[886] ^ output[54];
ciphertext[887] = plaintext[887] ^ output[55];
ciphertext[888] = plaintext[888] ^ output[56];
ciphertext[889] = plaintext[889] ^ output[57];
ciphertext[890] = plaintext[890] ^ output[58];
ciphertext[891] = plaintext[891] ^ output[59];
ciphertext[892] = plaintext[892] ^ output[60];
ciphertext[893] = plaintext[893] ^ output[61];
ciphertext[894] = plaintext[894] ^ output[62];
ciphertext[895] = plaintext[895] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
ciphertext[896] = plaintext[896] ^ output[0];
ciphertext[897] = plaintext[897] ^ output[1];
ciphertext[898] = plaintext[898] ^ output[2];
ciphertext[899] = plaintext[899] ^ output[3];
ciphertext[900] = plaintext[900] ^ output[4];
ciphertext[901] = plaintext[901] ^ output[5];
ciphertext[902] = plaintext[902] ^ output[6];
ciphertext[903] = plaintext[903] ^ output[7];
ciphertext[904] = plaintext[904] ^ output[8];
ciphertext[905] = plaintext[905] ^ output[9];
ciphertext[906] = plaintext[906] ^ output[10];
ciphertext[907] = plaintext[907] ^ output[11];
ciphertext[908] = plaintext[908] ^ output[12];
ciphertext[909] = plaintext[909] ^ output[13];
ciphertext[910] = plaintext[910] ^ output[14];
ciphertext[911] = plaintext[911] ^ output[15];
ciphertext[912] = plaintext[912] ^ output[16];
ciphertext[913] = plaintext[913] ^ output[17];
ciphertext[914] = plaintext[914] ^ output[18];
ciphertext[915] = plaintext[915] ^ output[19];
ciphertext[916] = plaintext[916] ^ output[20];
ciphertext[917] = plaintext[917] ^ output[21];
ciphertext[918] = plaintext[918] ^ output[22];
ciphertext[919] = plaintext[919] ^ output[23];
ciphertext[920] = plaintext[920] ^ output[24];
ciphertext[921] = plaintext[921] ^ output[25];
ciphertext[922] = plaintext[922] ^ output[26];
ciphertext[923] = plaintext[923] ^ output[27];
ciphertext[924] = plaintext[924] ^ output[28];
ciphertext[925] = plaintext[925] ^ output[29];
ciphertext[926] = plaintext[926] ^ output[30];
ciphertext[927] = plaintext[927] ^ output[31];
ciphertext[928] = plaintext[928] ^ output[32];
ciphertext[929] = plaintext[929] ^ output[33];
ciphertext[930] = plaintext[930] ^ output[34];
ciphertext[931] = plaintext[931] ^ output[35];
ciphertext[932] = plaintext[932] ^ output[36];
ciphertext[933] = plaintext[933] ^ output[37];
ciphertext[934] = plaintext[934] ^ output[38];
ciphertext[935] = plaintext[935] ^ output[39];
ciphertext[936] = plaintext[936] ^ output[40];
ciphertext[937] = plaintext[937] ^ output[41];
ciphertext[938] = plaintext[938] ^ output[42];
ciphertext[939] = plaintext[939] ^ output[43];
ciphertext[940] = plaintext[940] ^ output[44];
ciphertext[941] = plaintext[941] ^ output[45];
ciphertext[942] = plaintext[942] ^ output[46];
ciphertext[943] = plaintext[943] ^ output[47];
ciphertext[944] = plaintext[944] ^ output[48];
ciphertext[945] = plaintext[945] ^ output[49];
ciphertext[946] = plaintext[946] ^ output[50];
ciphertext[947] = plaintext[947] ^ output[51];
ciphertext[948] = plaintext[948] ^ output[52];
ciphertext[949] = plaintext[949] ^ output[53];
ciphertext[950] = plaintext[950] ^ output[54];
ciphertext[951] = plaintext[951] ^ output[55];
ciphertext[952] = plaintext[952] ^ output[56];
ciphertext[953] = plaintext[953] ^ output[57];
ciphertext[954] = plaintext[954] ^ output[58];
ciphertext[955] = plaintext[955] ^ output[59];
ciphertext[956] = plaintext[956] ^ output[60];
ciphertext[957] = plaintext[957] ^ output[61];
ciphertext[958] = plaintext[958] ^ output[62];
ciphertext[959] = plaintext[959] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
ciphertext[960] = plaintext[960] ^ output[0];
ciphertext[961] = plaintext[961] ^ output[1];
ciphertext[962] = plaintext[962] ^ output[2];
ciphertext[963] = plaintext[963] ^ output[3];
ciphertext[964] = plaintext[964] ^ output[4];
ciphertext[965] = plaintext[965] ^ output[5];
ciphertext[966] = plaintext[966] ^ output[6];
ciphertext[967] = plaintext[967] ^ output[7];
ciphertext[968] = plaintext[968] ^ output[8];
ciphertext[969] = plaintext[969] ^ output[9];
ciphertext[970] = plaintext[970] ^ output[10];
ciphertext[971] = plaintext[971] ^ output[11];
ciphertext[972] = plaintext[972] ^ output[12];
ciphertext[973] = plaintext[973] ^ output[13];
ciphertext[974] = plaintext[974] ^ output[14];
ciphertext[975] = plaintext[975] ^ output[15];
ciphertext[976] = plaintext[976] ^ output[16];
ciphertext[977] = plaintext[977] ^ output[17];
ciphertext[978] = plaintext[978] ^ output[18];
ciphertext[979] = plaintext[979] ^ output[19];
ciphertext[980] = plaintext[980] ^ output[20];
ciphertext[981] = plaintext[981] ^ output[21];
ciphertext[982] = plaintext[982] ^ output[22];
ciphertext[983] = plaintext[983] ^ output[23];
ciphertext[984] = plaintext[984] ^ output[24];
ciphertext[985] = plaintext[985] ^ output[25];
ciphertext[986] = plaintext[986] ^ output[26];
ciphertext[987] = plaintext[987] ^ output[27];
ciphertext[988] = plaintext[988] ^ output[28];
ciphertext[989] = plaintext[989] ^ output[29];
ciphertext[990] = plaintext[990] ^ output[30];
ciphertext[991] = plaintext[991] ^ output[31];
ciphertext[992] = plaintext[992] ^ output[32];
ciphertext[993] = plaintext[993] ^ output[33];
ciphertext[994] = plaintext[994] ^ output[34];
ciphertext[995] = plaintext[995] ^ output[35];
ciphertext[996] = plaintext[996] ^ output[36];
ciphertext[997] = plaintext[997] ^ output[37];
ciphertext[998] = plaintext[998] ^ output[38];
ciphertext[999] = plaintext[999] ^ output[39];
ciphertext[1000] = plaintext[1000] ^ output[40];
ciphertext[1001] = plaintext[1001] ^ output[41];
ciphertext[1002] = plaintext[1002] ^ output[42];
ciphertext[1003] = plaintext[1003] ^ output[43];
ciphertext[1004] = plaintext[1004] ^ output[44];
ciphertext[1005] = plaintext[1005] ^ output[45];
ciphertext[1006] = plaintext[1006] ^ output[46];
ciphertext[1007] = plaintext[1007] ^ output[47];
ciphertext[1008] = plaintext[1008] ^ output[48];
ciphertext[1009] = plaintext[1009] ^ output[49];
ciphertext[1010] = plaintext[1010] ^ output[50];
ciphertext[1011] = plaintext[1011] ^ output[51];
ciphertext[1012] = plaintext[1012] ^ output[52];
ciphertext[1013] = plaintext[1013] ^ output[53];
ciphertext[1014] = plaintext[1014] ^ output[54];
ciphertext[1015] = plaintext[1015] ^ output[55];
ciphertext[1016] = plaintext[1016] ^ output[56];
ciphertext[1017] = plaintext[1017] ^ output[57];
ciphertext[1018] = plaintext[1018] ^ output[58];
ciphertext[1019] = plaintext[1019] ^ output[59];
ciphertext[1020] = plaintext[1020] ^ output[60];
ciphertext[1021] = plaintext[1021] ^ output[61];
ciphertext[1022] = plaintext[1022] ^ output[62];
ciphertext[1023] = plaintext[1023] ^ output[63];


      uint64_t endT = rdtscp64();
      //printf("Time after: [%ld]\n", endT);
      //printf("Total time: [%ld]\n\n", endT - startT);
    printf("Total time: [%ld]\n", endT - startT);

    showData(ciphertext, "CIPHERTEXT");

    result = (u8 *)calloc((size_t)CHUNKSIZE, sizeof(u8));

    //Using the same key matrix (ctx), decrypts the message by xoring in the other direction
    ECRYPT_ivsetup(&ctx, IV);

    x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
result[0] = ciphertext[0] ^ output[0];
result[1] = ciphertext[1] ^ output[1];
result[2] = ciphertext[2] ^ output[2];
result[3] = ciphertext[3] ^ output[3];
result[4] = ciphertext[4] ^ output[4];
result[5] = ciphertext[5] ^ output[5];
result[6] = ciphertext[6] ^ output[6];
result[7] = ciphertext[7] ^ output[7];
result[8] = ciphertext[8] ^ output[8];
result[9] = ciphertext[9] ^ output[9];
result[10] = ciphertext[10] ^ output[10];
result[11] = ciphertext[11] ^ output[11];
result[12] = ciphertext[12] ^ output[12];
result[13] = ciphertext[13] ^ output[13];
result[14] = ciphertext[14] ^ output[14];
result[15] = ciphertext[15] ^ output[15];
result[16] = ciphertext[16] ^ output[16];
result[17] = ciphertext[17] ^ output[17];
result[18] = ciphertext[18] ^ output[18];
result[19] = ciphertext[19] ^ output[19];
result[20] = ciphertext[20] ^ output[20];
result[21] = ciphertext[21] ^ output[21];
result[22] = ciphertext[22] ^ output[22];
result[23] = ciphertext[23] ^ output[23];
result[24] = ciphertext[24] ^ output[24];
result[25] = ciphertext[25] ^ output[25];
result[26] = ciphertext[26] ^ output[26];
result[27] = ciphertext[27] ^ output[27];
result[28] = ciphertext[28] ^ output[28];
result[29] = ciphertext[29] ^ output[29];
result[30] = ciphertext[30] ^ output[30];
result[31] = ciphertext[31] ^ output[31];
result[32] = ciphertext[32] ^ output[32];
result[33] = ciphertext[33] ^ output[33];
result[34] = ciphertext[34] ^ output[34];
result[35] = ciphertext[35] ^ output[35];
result[36] = ciphertext[36] ^ output[36];
result[37] = ciphertext[37] ^ output[37];
result[38] = ciphertext[38] ^ output[38];
result[39] = ciphertext[39] ^ output[39];
result[40] = ciphertext[40] ^ output[40];
result[41] = ciphertext[41] ^ output[41];
result[42] = ciphertext[42] ^ output[42];
result[43] = ciphertext[43] ^ output[43];
result[44] = ciphertext[44] ^ output[44];
result[45] = ciphertext[45] ^ output[45];
result[46] = ciphertext[46] ^ output[46];
result[47] = ciphertext[47] ^ output[47];
result[48] = ciphertext[48] ^ output[48];
result[49] = ciphertext[49] ^ output[49];
result[50] = ciphertext[50] ^ output[50];
result[51] = ciphertext[51] ^ output[51];
result[52] = ciphertext[52] ^ output[52];
result[53] = ciphertext[53] ^ output[53];
result[54] = ciphertext[54] ^ output[54];
result[55] = ciphertext[55] ^ output[55];
result[56] = ciphertext[56] ^ output[56];
result[57] = ciphertext[57] ^ output[57];
result[58] = ciphertext[58] ^ output[58];
result[59] = ciphertext[59] ^ output[59];
result[60] = ciphertext[60] ^ output[60];
result[61] = ciphertext[61] ^ output[61];
result[62] = ciphertext[62] ^ output[62];
result[63] = ciphertext[63] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
result[64] = ciphertext[64] ^ output[0];
result[65] = ciphertext[65] ^ output[1];
result[66] = ciphertext[66] ^ output[2];
result[67] = ciphertext[67] ^ output[3];
result[68] = ciphertext[68] ^ output[4];
result[69] = ciphertext[69] ^ output[5];
result[70] = ciphertext[70] ^ output[6];
result[71] = ciphertext[71] ^ output[7];
result[72] = ciphertext[72] ^ output[8];
result[73] = ciphertext[73] ^ output[9];
result[74] = ciphertext[74] ^ output[10];
result[75] = ciphertext[75] ^ output[11];
result[76] = ciphertext[76] ^ output[12];
result[77] = ciphertext[77] ^ output[13];
result[78] = ciphertext[78] ^ output[14];
result[79] = ciphertext[79] ^ output[15];
result[80] = ciphertext[80] ^ output[16];
result[81] = ciphertext[81] ^ output[17];
result[82] = ciphertext[82] ^ output[18];
result[83] = ciphertext[83] ^ output[19];
result[84] = ciphertext[84] ^ output[20];
result[85] = ciphertext[85] ^ output[21];
result[86] = ciphertext[86] ^ output[22];
result[87] = ciphertext[87] ^ output[23];
result[88] = ciphertext[88] ^ output[24];
result[89] = ciphertext[89] ^ output[25];
result[90] = ciphertext[90] ^ output[26];
result[91] = ciphertext[91] ^ output[27];
result[92] = ciphertext[92] ^ output[28];
result[93] = ciphertext[93] ^ output[29];
result[94] = ciphertext[94] ^ output[30];
result[95] = ciphertext[95] ^ output[31];
result[96] = ciphertext[96] ^ output[32];
result[97] = ciphertext[97] ^ output[33];
result[98] = ciphertext[98] ^ output[34];
result[99] = ciphertext[99] ^ output[35];
result[100] = ciphertext[100] ^ output[36];
result[101] = ciphertext[101] ^ output[37];
result[102] = ciphertext[102] ^ output[38];
result[103] = ciphertext[103] ^ output[39];
result[104] = ciphertext[104] ^ output[40];
result[105] = ciphertext[105] ^ output[41];
result[106] = ciphertext[106] ^ output[42];
result[107] = ciphertext[107] ^ output[43];
result[108] = ciphertext[108] ^ output[44];
result[109] = ciphertext[109] ^ output[45];
result[110] = ciphertext[110] ^ output[46];
result[111] = ciphertext[111] ^ output[47];
result[112] = ciphertext[112] ^ output[48];
result[113] = ciphertext[113] ^ output[49];
result[114] = ciphertext[114] ^ output[50];
result[115] = ciphertext[115] ^ output[51];
result[116] = ciphertext[116] ^ output[52];
result[117] = ciphertext[117] ^ output[53];
result[118] = ciphertext[118] ^ output[54];
result[119] = ciphertext[119] ^ output[55];
result[120] = ciphertext[120] ^ output[56];
result[121] = ciphertext[121] ^ output[57];
result[122] = ciphertext[122] ^ output[58];
result[123] = ciphertext[123] ^ output[59];
result[124] = ciphertext[124] ^ output[60];
result[125] = ciphertext[125] ^ output[61];
result[126] = ciphertext[126] ^ output[62];
result[127] = ciphertext[127] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
result[128] = ciphertext[128] ^ output[0];
result[129] = ciphertext[129] ^ output[1];
result[130] = ciphertext[130] ^ output[2];
result[131] = ciphertext[131] ^ output[3];
result[132] = ciphertext[132] ^ output[4];
result[133] = ciphertext[133] ^ output[5];
result[134] = ciphertext[134] ^ output[6];
result[135] = ciphertext[135] ^ output[7];
result[136] = ciphertext[136] ^ output[8];
result[137] = ciphertext[137] ^ output[9];
result[138] = ciphertext[138] ^ output[10];
result[139] = ciphertext[139] ^ output[11];
result[140] = ciphertext[140] ^ output[12];
result[141] = ciphertext[141] ^ output[13];
result[142] = ciphertext[142] ^ output[14];
result[143] = ciphertext[143] ^ output[15];
result[144] = ciphertext[144] ^ output[16];
result[145] = ciphertext[145] ^ output[17];
result[146] = ciphertext[146] ^ output[18];
result[147] = ciphertext[147] ^ output[19];
result[148] = ciphertext[148] ^ output[20];
result[149] = ciphertext[149] ^ output[21];
result[150] = ciphertext[150] ^ output[22];
result[151] = ciphertext[151] ^ output[23];
result[152] = ciphertext[152] ^ output[24];
result[153] = ciphertext[153] ^ output[25];
result[154] = ciphertext[154] ^ output[26];
result[155] = ciphertext[155] ^ output[27];
result[156] = ciphertext[156] ^ output[28];
result[157] = ciphertext[157] ^ output[29];
result[158] = ciphertext[158] ^ output[30];
result[159] = ciphertext[159] ^ output[31];
result[160] = ciphertext[160] ^ output[32];
result[161] = ciphertext[161] ^ output[33];
result[162] = ciphertext[162] ^ output[34];
result[163] = ciphertext[163] ^ output[35];
result[164] = ciphertext[164] ^ output[36];
result[165] = ciphertext[165] ^ output[37];
result[166] = ciphertext[166] ^ output[38];
result[167] = ciphertext[167] ^ output[39];
result[168] = ciphertext[168] ^ output[40];
result[169] = ciphertext[169] ^ output[41];
result[170] = ciphertext[170] ^ output[42];
result[171] = ciphertext[171] ^ output[43];
result[172] = ciphertext[172] ^ output[44];
result[173] = ciphertext[173] ^ output[45];
result[174] = ciphertext[174] ^ output[46];
result[175] = ciphertext[175] ^ output[47];
result[176] = ciphertext[176] ^ output[48];
result[177] = ciphertext[177] ^ output[49];
result[178] = ciphertext[178] ^ output[50];
result[179] = ciphertext[179] ^ output[51];
result[180] = ciphertext[180] ^ output[52];
result[181] = ciphertext[181] ^ output[53];
result[182] = ciphertext[182] ^ output[54];
result[183] = ciphertext[183] ^ output[55];
result[184] = ciphertext[184] ^ output[56];
result[185] = ciphertext[185] ^ output[57];
result[186] = ciphertext[186] ^ output[58];
result[187] = ciphertext[187] ^ output[59];
result[188] = ciphertext[188] ^ output[60];
result[189] = ciphertext[189] ^ output[61];
result[190] = ciphertext[190] ^ output[62];
result[191] = ciphertext[191] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
result[192] = ciphertext[192] ^ output[0];
result[193] = ciphertext[193] ^ output[1];
result[194] = ciphertext[194] ^ output[2];
result[195] = ciphertext[195] ^ output[3];
result[196] = ciphertext[196] ^ output[4];
result[197] = ciphertext[197] ^ output[5];
result[198] = ciphertext[198] ^ output[6];
result[199] = ciphertext[199] ^ output[7];
result[200] = ciphertext[200] ^ output[8];
result[201] = ciphertext[201] ^ output[9];
result[202] = ciphertext[202] ^ output[10];
result[203] = ciphertext[203] ^ output[11];
result[204] = ciphertext[204] ^ output[12];
result[205] = ciphertext[205] ^ output[13];
result[206] = ciphertext[206] ^ output[14];
result[207] = ciphertext[207] ^ output[15];
result[208] = ciphertext[208] ^ output[16];
result[209] = ciphertext[209] ^ output[17];
result[210] = ciphertext[210] ^ output[18];
result[211] = ciphertext[211] ^ output[19];
result[212] = ciphertext[212] ^ output[20];
result[213] = ciphertext[213] ^ output[21];
result[214] = ciphertext[214] ^ output[22];
result[215] = ciphertext[215] ^ output[23];
result[216] = ciphertext[216] ^ output[24];
result[217] = ciphertext[217] ^ output[25];
result[218] = ciphertext[218] ^ output[26];
result[219] = ciphertext[219] ^ output[27];
result[220] = ciphertext[220] ^ output[28];
result[221] = ciphertext[221] ^ output[29];
result[222] = ciphertext[222] ^ output[30];
result[223] = ciphertext[223] ^ output[31];
result[224] = ciphertext[224] ^ output[32];
result[225] = ciphertext[225] ^ output[33];
result[226] = ciphertext[226] ^ output[34];
result[227] = ciphertext[227] ^ output[35];
result[228] = ciphertext[228] ^ output[36];
result[229] = ciphertext[229] ^ output[37];
result[230] = ciphertext[230] ^ output[38];
result[231] = ciphertext[231] ^ output[39];
result[232] = ciphertext[232] ^ output[40];
result[233] = ciphertext[233] ^ output[41];
result[234] = ciphertext[234] ^ output[42];
result[235] = ciphertext[235] ^ output[43];
result[236] = ciphertext[236] ^ output[44];
result[237] = ciphertext[237] ^ output[45];
result[238] = ciphertext[238] ^ output[46];
result[239] = ciphertext[239] ^ output[47];
result[240] = ciphertext[240] ^ output[48];
result[241] = ciphertext[241] ^ output[49];
result[242] = ciphertext[242] ^ output[50];
result[243] = ciphertext[243] ^ output[51];
result[244] = ciphertext[244] ^ output[52];
result[245] = ciphertext[245] ^ output[53];
result[246] = ciphertext[246] ^ output[54];
result[247] = ciphertext[247] ^ output[55];
result[248] = ciphertext[248] ^ output[56];
result[249] = ciphertext[249] ^ output[57];
result[250] = ciphertext[250] ^ output[58];
result[251] = ciphertext[251] ^ output[59];
result[252] = ciphertext[252] ^ output[60];
result[253] = ciphertext[253] ^ output[61];
result[254] = ciphertext[254] ^ output[62];
result[255] = ciphertext[255] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
result[256] = ciphertext[256] ^ output[0];
result[257] = ciphertext[257] ^ output[1];
result[258] = ciphertext[258] ^ output[2];
result[259] = ciphertext[259] ^ output[3];
result[260] = ciphertext[260] ^ output[4];
result[261] = ciphertext[261] ^ output[5];
result[262] = ciphertext[262] ^ output[6];
result[263] = ciphertext[263] ^ output[7];
result[264] = ciphertext[264] ^ output[8];
result[265] = ciphertext[265] ^ output[9];
result[266] = ciphertext[266] ^ output[10];
result[267] = ciphertext[267] ^ output[11];
result[268] = ciphertext[268] ^ output[12];
result[269] = ciphertext[269] ^ output[13];
result[270] = ciphertext[270] ^ output[14];
result[271] = ciphertext[271] ^ output[15];
result[272] = ciphertext[272] ^ output[16];
result[273] = ciphertext[273] ^ output[17];
result[274] = ciphertext[274] ^ output[18];
result[275] = ciphertext[275] ^ output[19];
result[276] = ciphertext[276] ^ output[20];
result[277] = ciphertext[277] ^ output[21];
result[278] = ciphertext[278] ^ output[22];
result[279] = ciphertext[279] ^ output[23];
result[280] = ciphertext[280] ^ output[24];
result[281] = ciphertext[281] ^ output[25];
result[282] = ciphertext[282] ^ output[26];
result[283] = ciphertext[283] ^ output[27];
result[284] = ciphertext[284] ^ output[28];
result[285] = ciphertext[285] ^ output[29];
result[286] = ciphertext[286] ^ output[30];
result[287] = ciphertext[287] ^ output[31];
result[288] = ciphertext[288] ^ output[32];
result[289] = ciphertext[289] ^ output[33];
result[290] = ciphertext[290] ^ output[34];
result[291] = ciphertext[291] ^ output[35];
result[292] = ciphertext[292] ^ output[36];
result[293] = ciphertext[293] ^ output[37];
result[294] = ciphertext[294] ^ output[38];
result[295] = ciphertext[295] ^ output[39];
result[296] = ciphertext[296] ^ output[40];
result[297] = ciphertext[297] ^ output[41];
result[298] = ciphertext[298] ^ output[42];
result[299] = ciphertext[299] ^ output[43];
result[300] = ciphertext[300] ^ output[44];
result[301] = ciphertext[301] ^ output[45];
result[302] = ciphertext[302] ^ output[46];
result[303] = ciphertext[303] ^ output[47];
result[304] = ciphertext[304] ^ output[48];
result[305] = ciphertext[305] ^ output[49];
result[306] = ciphertext[306] ^ output[50];
result[307] = ciphertext[307] ^ output[51];
result[308] = ciphertext[308] ^ output[52];
result[309] = ciphertext[309] ^ output[53];
result[310] = ciphertext[310] ^ output[54];
result[311] = ciphertext[311] ^ output[55];
result[312] = ciphertext[312] ^ output[56];
result[313] = ciphertext[313] ^ output[57];
result[314] = ciphertext[314] ^ output[58];
result[315] = ciphertext[315] ^ output[59];
result[316] = ciphertext[316] ^ output[60];
result[317] = ciphertext[317] ^ output[61];
result[318] = ciphertext[318] ^ output[62];
result[319] = ciphertext[319] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
result[320] = ciphertext[320] ^ output[0];
result[321] = ciphertext[321] ^ output[1];
result[322] = ciphertext[322] ^ output[2];
result[323] = ciphertext[323] ^ output[3];
result[324] = ciphertext[324] ^ output[4];
result[325] = ciphertext[325] ^ output[5];
result[326] = ciphertext[326] ^ output[6];
result[327] = ciphertext[327] ^ output[7];
result[328] = ciphertext[328] ^ output[8];
result[329] = ciphertext[329] ^ output[9];
result[330] = ciphertext[330] ^ output[10];
result[331] = ciphertext[331] ^ output[11];
result[332] = ciphertext[332] ^ output[12];
result[333] = ciphertext[333] ^ output[13];
result[334] = ciphertext[334] ^ output[14];
result[335] = ciphertext[335] ^ output[15];
result[336] = ciphertext[336] ^ output[16];
result[337] = ciphertext[337] ^ output[17];
result[338] = ciphertext[338] ^ output[18];
result[339] = ciphertext[339] ^ output[19];
result[340] = ciphertext[340] ^ output[20];
result[341] = ciphertext[341] ^ output[21];
result[342] = ciphertext[342] ^ output[22];
result[343] = ciphertext[343] ^ output[23];
result[344] = ciphertext[344] ^ output[24];
result[345] = ciphertext[345] ^ output[25];
result[346] = ciphertext[346] ^ output[26];
result[347] = ciphertext[347] ^ output[27];
result[348] = ciphertext[348] ^ output[28];
result[349] = ciphertext[349] ^ output[29];
result[350] = ciphertext[350] ^ output[30];
result[351] = ciphertext[351] ^ output[31];
result[352] = ciphertext[352] ^ output[32];
result[353] = ciphertext[353] ^ output[33];
result[354] = ciphertext[354] ^ output[34];
result[355] = ciphertext[355] ^ output[35];
result[356] = ciphertext[356] ^ output[36];
result[357] = ciphertext[357] ^ output[37];
result[358] = ciphertext[358] ^ output[38];
result[359] = ciphertext[359] ^ output[39];
result[360] = ciphertext[360] ^ output[40];
result[361] = ciphertext[361] ^ output[41];
result[362] = ciphertext[362] ^ output[42];
result[363] = ciphertext[363] ^ output[43];
result[364] = ciphertext[364] ^ output[44];
result[365] = ciphertext[365] ^ output[45];
result[366] = ciphertext[366] ^ output[46];
result[367] = ciphertext[367] ^ output[47];
result[368] = ciphertext[368] ^ output[48];
result[369] = ciphertext[369] ^ output[49];
result[370] = ciphertext[370] ^ output[50];
result[371] = ciphertext[371] ^ output[51];
result[372] = ciphertext[372] ^ output[52];
result[373] = ciphertext[373] ^ output[53];
result[374] = ciphertext[374] ^ output[54];
result[375] = ciphertext[375] ^ output[55];
result[376] = ciphertext[376] ^ output[56];
result[377] = ciphertext[377] ^ output[57];
result[378] = ciphertext[378] ^ output[58];
result[379] = ciphertext[379] ^ output[59];
result[380] = ciphertext[380] ^ output[60];
result[381] = ciphertext[381] ^ output[61];
result[382] = ciphertext[382] ^ output[62];
result[383] = ciphertext[383] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
result[384] = ciphertext[384] ^ output[0];
result[385] = ciphertext[385] ^ output[1];
result[386] = ciphertext[386] ^ output[2];
result[387] = ciphertext[387] ^ output[3];
result[388] = ciphertext[388] ^ output[4];
result[389] = ciphertext[389] ^ output[5];
result[390] = ciphertext[390] ^ output[6];
result[391] = ciphertext[391] ^ output[7];
result[392] = ciphertext[392] ^ output[8];
result[393] = ciphertext[393] ^ output[9];
result[394] = ciphertext[394] ^ output[10];
result[395] = ciphertext[395] ^ output[11];
result[396] = ciphertext[396] ^ output[12];
result[397] = ciphertext[397] ^ output[13];
result[398] = ciphertext[398] ^ output[14];
result[399] = ciphertext[399] ^ output[15];
result[400] = ciphertext[400] ^ output[16];
result[401] = ciphertext[401] ^ output[17];
result[402] = ciphertext[402] ^ output[18];
result[403] = ciphertext[403] ^ output[19];
result[404] = ciphertext[404] ^ output[20];
result[405] = ciphertext[405] ^ output[21];
result[406] = ciphertext[406] ^ output[22];
result[407] = ciphertext[407] ^ output[23];
result[408] = ciphertext[408] ^ output[24];
result[409] = ciphertext[409] ^ output[25];
result[410] = ciphertext[410] ^ output[26];
result[411] = ciphertext[411] ^ output[27];
result[412] = ciphertext[412] ^ output[28];
result[413] = ciphertext[413] ^ output[29];
result[414] = ciphertext[414] ^ output[30];
result[415] = ciphertext[415] ^ output[31];
result[416] = ciphertext[416] ^ output[32];
result[417] = ciphertext[417] ^ output[33];
result[418] = ciphertext[418] ^ output[34];
result[419] = ciphertext[419] ^ output[35];
result[420] = ciphertext[420] ^ output[36];
result[421] = ciphertext[421] ^ output[37];
result[422] = ciphertext[422] ^ output[38];
result[423] = ciphertext[423] ^ output[39];
result[424] = ciphertext[424] ^ output[40];
result[425] = ciphertext[425] ^ output[41];
result[426] = ciphertext[426] ^ output[42];
result[427] = ciphertext[427] ^ output[43];
result[428] = ciphertext[428] ^ output[44];
result[429] = ciphertext[429] ^ output[45];
result[430] = ciphertext[430] ^ output[46];
result[431] = ciphertext[431] ^ output[47];
result[432] = ciphertext[432] ^ output[48];
result[433] = ciphertext[433] ^ output[49];
result[434] = ciphertext[434] ^ output[50];
result[435] = ciphertext[435] ^ output[51];
result[436] = ciphertext[436] ^ output[52];
result[437] = ciphertext[437] ^ output[53];
result[438] = ciphertext[438] ^ output[54];
result[439] = ciphertext[439] ^ output[55];
result[440] = ciphertext[440] ^ output[56];
result[441] = ciphertext[441] ^ output[57];
result[442] = ciphertext[442] ^ output[58];
result[443] = ciphertext[443] ^ output[59];
result[444] = ciphertext[444] ^ output[60];
result[445] = ciphertext[445] ^ output[61];
result[446] = ciphertext[446] ^ output[62];
result[447] = ciphertext[447] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
result[448] = ciphertext[448] ^ output[0];
result[449] = ciphertext[449] ^ output[1];
result[450] = ciphertext[450] ^ output[2];
result[451] = ciphertext[451] ^ output[3];
result[452] = ciphertext[452] ^ output[4];
result[453] = ciphertext[453] ^ output[5];
result[454] = ciphertext[454] ^ output[6];
result[455] = ciphertext[455] ^ output[7];
result[456] = ciphertext[456] ^ output[8];
result[457] = ciphertext[457] ^ output[9];
result[458] = ciphertext[458] ^ output[10];
result[459] = ciphertext[459] ^ output[11];
result[460] = ciphertext[460] ^ output[12];
result[461] = ciphertext[461] ^ output[13];
result[462] = ciphertext[462] ^ output[14];
result[463] = ciphertext[463] ^ output[15];
result[464] = ciphertext[464] ^ output[16];
result[465] = ciphertext[465] ^ output[17];
result[466] = ciphertext[466] ^ output[18];
result[467] = ciphertext[467] ^ output[19];
result[468] = ciphertext[468] ^ output[20];
result[469] = ciphertext[469] ^ output[21];
result[470] = ciphertext[470] ^ output[22];
result[471] = ciphertext[471] ^ output[23];
result[472] = ciphertext[472] ^ output[24];
result[473] = ciphertext[473] ^ output[25];
result[474] = ciphertext[474] ^ output[26];
result[475] = ciphertext[475] ^ output[27];
result[476] = ciphertext[476] ^ output[28];
result[477] = ciphertext[477] ^ output[29];
result[478] = ciphertext[478] ^ output[30];
result[479] = ciphertext[479] ^ output[31];
result[480] = ciphertext[480] ^ output[32];
result[481] = ciphertext[481] ^ output[33];
result[482] = ciphertext[482] ^ output[34];
result[483] = ciphertext[483] ^ output[35];
result[484] = ciphertext[484] ^ output[36];
result[485] = ciphertext[485] ^ output[37];
result[486] = ciphertext[486] ^ output[38];
result[487] = ciphertext[487] ^ output[39];
result[488] = ciphertext[488] ^ output[40];
result[489] = ciphertext[489] ^ output[41];
result[490] = ciphertext[490] ^ output[42];
result[491] = ciphertext[491] ^ output[43];
result[492] = ciphertext[492] ^ output[44];
result[493] = ciphertext[493] ^ output[45];
result[494] = ciphertext[494] ^ output[46];
result[495] = ciphertext[495] ^ output[47];
result[496] = ciphertext[496] ^ output[48];
result[497] = ciphertext[497] ^ output[49];
result[498] = ciphertext[498] ^ output[50];
result[499] = ciphertext[499] ^ output[51];
result[500] = ciphertext[500] ^ output[52];
result[501] = ciphertext[501] ^ output[53];
result[502] = ciphertext[502] ^ output[54];
result[503] = ciphertext[503] ^ output[55];
result[504] = ciphertext[504] ^ output[56];
result[505] = ciphertext[505] ^ output[57];
result[506] = ciphertext[506] ^ output[58];
result[507] = ciphertext[507] ^ output[59];
result[508] = ciphertext[508] ^ output[60];
result[509] = ciphertext[509] ^ output[61];
result[510] = ciphertext[510] ^ output[62];
result[511] = ciphertext[511] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
result[512] = ciphertext[512] ^ output[0];
result[513] = ciphertext[513] ^ output[1];
result[514] = ciphertext[514] ^ output[2];
result[515] = ciphertext[515] ^ output[3];
result[516] = ciphertext[516] ^ output[4];
result[517] = ciphertext[517] ^ output[5];
result[518] = ciphertext[518] ^ output[6];
result[519] = ciphertext[519] ^ output[7];
result[520] = ciphertext[520] ^ output[8];
result[521] = ciphertext[521] ^ output[9];
result[522] = ciphertext[522] ^ output[10];
result[523] = ciphertext[523] ^ output[11];
result[524] = ciphertext[524] ^ output[12];
result[525] = ciphertext[525] ^ output[13];
result[526] = ciphertext[526] ^ output[14];
result[527] = ciphertext[527] ^ output[15];
result[528] = ciphertext[528] ^ output[16];
result[529] = ciphertext[529] ^ output[17];
result[530] = ciphertext[530] ^ output[18];
result[531] = ciphertext[531] ^ output[19];
result[532] = ciphertext[532] ^ output[20];
result[533] = ciphertext[533] ^ output[21];
result[534] = ciphertext[534] ^ output[22];
result[535] = ciphertext[535] ^ output[23];
result[536] = ciphertext[536] ^ output[24];
result[537] = ciphertext[537] ^ output[25];
result[538] = ciphertext[538] ^ output[26];
result[539] = ciphertext[539] ^ output[27];
result[540] = ciphertext[540] ^ output[28];
result[541] = ciphertext[541] ^ output[29];
result[542] = ciphertext[542] ^ output[30];
result[543] = ciphertext[543] ^ output[31];
result[544] = ciphertext[544] ^ output[32];
result[545] = ciphertext[545] ^ output[33];
result[546] = ciphertext[546] ^ output[34];
result[547] = ciphertext[547] ^ output[35];
result[548] = ciphertext[548] ^ output[36];
result[549] = ciphertext[549] ^ output[37];
result[550] = ciphertext[550] ^ output[38];
result[551] = ciphertext[551] ^ output[39];
result[552] = ciphertext[552] ^ output[40];
result[553] = ciphertext[553] ^ output[41];
result[554] = ciphertext[554] ^ output[42];
result[555] = ciphertext[555] ^ output[43];
result[556] = ciphertext[556] ^ output[44];
result[557] = ciphertext[557] ^ output[45];
result[558] = ciphertext[558] ^ output[46];
result[559] = ciphertext[559] ^ output[47];
result[560] = ciphertext[560] ^ output[48];
result[561] = ciphertext[561] ^ output[49];
result[562] = ciphertext[562] ^ output[50];
result[563] = ciphertext[563] ^ output[51];
result[564] = ciphertext[564] ^ output[52];
result[565] = ciphertext[565] ^ output[53];
result[566] = ciphertext[566] ^ output[54];
result[567] = ciphertext[567] ^ output[55];
result[568] = ciphertext[568] ^ output[56];
result[569] = ciphertext[569] ^ output[57];
result[570] = ciphertext[570] ^ output[58];
result[571] = ciphertext[571] ^ output[59];
result[572] = ciphertext[572] ^ output[60];
result[573] = ciphertext[573] ^ output[61];
result[574] = ciphertext[574] ^ output[62];
result[575] = ciphertext[575] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
result[576] = ciphertext[576] ^ output[0];
result[577] = ciphertext[577] ^ output[1];
result[578] = ciphertext[578] ^ output[2];
result[579] = ciphertext[579] ^ output[3];
result[580] = ciphertext[580] ^ output[4];
result[581] = ciphertext[581] ^ output[5];
result[582] = ciphertext[582] ^ output[6];
result[583] = ciphertext[583] ^ output[7];
result[584] = ciphertext[584] ^ output[8];
result[585] = ciphertext[585] ^ output[9];
result[586] = ciphertext[586] ^ output[10];
result[587] = ciphertext[587] ^ output[11];
result[588] = ciphertext[588] ^ output[12];
result[589] = ciphertext[589] ^ output[13];
result[590] = ciphertext[590] ^ output[14];
result[591] = ciphertext[591] ^ output[15];
result[592] = ciphertext[592] ^ output[16];
result[593] = ciphertext[593] ^ output[17];
result[594] = ciphertext[594] ^ output[18];
result[595] = ciphertext[595] ^ output[19];
result[596] = ciphertext[596] ^ output[20];
result[597] = ciphertext[597] ^ output[21];
result[598] = ciphertext[598] ^ output[22];
result[599] = ciphertext[599] ^ output[23];
result[600] = ciphertext[600] ^ output[24];
result[601] = ciphertext[601] ^ output[25];
result[602] = ciphertext[602] ^ output[26];
result[603] = ciphertext[603] ^ output[27];
result[604] = ciphertext[604] ^ output[28];
result[605] = ciphertext[605] ^ output[29];
result[606] = ciphertext[606] ^ output[30];
result[607] = ciphertext[607] ^ output[31];
result[608] = ciphertext[608] ^ output[32];
result[609] = ciphertext[609] ^ output[33];
result[610] = ciphertext[610] ^ output[34];
result[611] = ciphertext[611] ^ output[35];
result[612] = ciphertext[612] ^ output[36];
result[613] = ciphertext[613] ^ output[37];
result[614] = ciphertext[614] ^ output[38];
result[615] = ciphertext[615] ^ output[39];
result[616] = ciphertext[616] ^ output[40];
result[617] = ciphertext[617] ^ output[41];
result[618] = ciphertext[618] ^ output[42];
result[619] = ciphertext[619] ^ output[43];
result[620] = ciphertext[620] ^ output[44];
result[621] = ciphertext[621] ^ output[45];
result[622] = ciphertext[622] ^ output[46];
result[623] = ciphertext[623] ^ output[47];
result[624] = ciphertext[624] ^ output[48];
result[625] = ciphertext[625] ^ output[49];
result[626] = ciphertext[626] ^ output[50];
result[627] = ciphertext[627] ^ output[51];
result[628] = ciphertext[628] ^ output[52];
result[629] = ciphertext[629] ^ output[53];
result[630] = ciphertext[630] ^ output[54];
result[631] = ciphertext[631] ^ output[55];
result[632] = ciphertext[632] ^ output[56];
result[633] = ciphertext[633] ^ output[57];
result[634] = ciphertext[634] ^ output[58];
result[635] = ciphertext[635] ^ output[59];
result[636] = ciphertext[636] ^ output[60];
result[637] = ciphertext[637] ^ output[61];
result[638] = ciphertext[638] ^ output[62];
result[639] = ciphertext[639] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
result[640] = ciphertext[640] ^ output[0];
result[641] = ciphertext[641] ^ output[1];
result[642] = ciphertext[642] ^ output[2];
result[643] = ciphertext[643] ^ output[3];
result[644] = ciphertext[644] ^ output[4];
result[645] = ciphertext[645] ^ output[5];
result[646] = ciphertext[646] ^ output[6];
result[647] = ciphertext[647] ^ output[7];
result[648] = ciphertext[648] ^ output[8];
result[649] = ciphertext[649] ^ output[9];
result[650] = ciphertext[650] ^ output[10];
result[651] = ciphertext[651] ^ output[11];
result[652] = ciphertext[652] ^ output[12];
result[653] = ciphertext[653] ^ output[13];
result[654] = ciphertext[654] ^ output[14];
result[655] = ciphertext[655] ^ output[15];
result[656] = ciphertext[656] ^ output[16];
result[657] = ciphertext[657] ^ output[17];
result[658] = ciphertext[658] ^ output[18];
result[659] = ciphertext[659] ^ output[19];
result[660] = ciphertext[660] ^ output[20];
result[661] = ciphertext[661] ^ output[21];
result[662] = ciphertext[662] ^ output[22];
result[663] = ciphertext[663] ^ output[23];
result[664] = ciphertext[664] ^ output[24];
result[665] = ciphertext[665] ^ output[25];
result[666] = ciphertext[666] ^ output[26];
result[667] = ciphertext[667] ^ output[27];
result[668] = ciphertext[668] ^ output[28];
result[669] = ciphertext[669] ^ output[29];
result[670] = ciphertext[670] ^ output[30];
result[671] = ciphertext[671] ^ output[31];
result[672] = ciphertext[672] ^ output[32];
result[673] = ciphertext[673] ^ output[33];
result[674] = ciphertext[674] ^ output[34];
result[675] = ciphertext[675] ^ output[35];
result[676] = ciphertext[676] ^ output[36];
result[677] = ciphertext[677] ^ output[37];
result[678] = ciphertext[678] ^ output[38];
result[679] = ciphertext[679] ^ output[39];
result[680] = ciphertext[680] ^ output[40];
result[681] = ciphertext[681] ^ output[41];
result[682] = ciphertext[682] ^ output[42];
result[683] = ciphertext[683] ^ output[43];
result[684] = ciphertext[684] ^ output[44];
result[685] = ciphertext[685] ^ output[45];
result[686] = ciphertext[686] ^ output[46];
result[687] = ciphertext[687] ^ output[47];
result[688] = ciphertext[688] ^ output[48];
result[689] = ciphertext[689] ^ output[49];
result[690] = ciphertext[690] ^ output[50];
result[691] = ciphertext[691] ^ output[51];
result[692] = ciphertext[692] ^ output[52];
result[693] = ciphertext[693] ^ output[53];
result[694] = ciphertext[694] ^ output[54];
result[695] = ciphertext[695] ^ output[55];
result[696] = ciphertext[696] ^ output[56];
result[697] = ciphertext[697] ^ output[57];
result[698] = ciphertext[698] ^ output[58];
result[699] = ciphertext[699] ^ output[59];
result[700] = ciphertext[700] ^ output[60];
result[701] = ciphertext[701] ^ output[61];
result[702] = ciphertext[702] ^ output[62];
result[703] = ciphertext[703] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
result[704] = ciphertext[704] ^ output[0];
result[705] = ciphertext[705] ^ output[1];
result[706] = ciphertext[706] ^ output[2];
result[707] = ciphertext[707] ^ output[3];
result[708] = ciphertext[708] ^ output[4];
result[709] = ciphertext[709] ^ output[5];
result[710] = ciphertext[710] ^ output[6];
result[711] = ciphertext[711] ^ output[7];
result[712] = ciphertext[712] ^ output[8];
result[713] = ciphertext[713] ^ output[9];
result[714] = ciphertext[714] ^ output[10];
result[715] = ciphertext[715] ^ output[11];
result[716] = ciphertext[716] ^ output[12];
result[717] = ciphertext[717] ^ output[13];
result[718] = ciphertext[718] ^ output[14];
result[719] = ciphertext[719] ^ output[15];
result[720] = ciphertext[720] ^ output[16];
result[721] = ciphertext[721] ^ output[17];
result[722] = ciphertext[722] ^ output[18];
result[723] = ciphertext[723] ^ output[19];
result[724] = ciphertext[724] ^ output[20];
result[725] = ciphertext[725] ^ output[21];
result[726] = ciphertext[726] ^ output[22];
result[727] = ciphertext[727] ^ output[23];
result[728] = ciphertext[728] ^ output[24];
result[729] = ciphertext[729] ^ output[25];
result[730] = ciphertext[730] ^ output[26];
result[731] = ciphertext[731] ^ output[27];
result[732] = ciphertext[732] ^ output[28];
result[733] = ciphertext[733] ^ output[29];
result[734] = ciphertext[734] ^ output[30];
result[735] = ciphertext[735] ^ output[31];
result[736] = ciphertext[736] ^ output[32];
result[737] = ciphertext[737] ^ output[33];
result[738] = ciphertext[738] ^ output[34];
result[739] = ciphertext[739] ^ output[35];
result[740] = ciphertext[740] ^ output[36];
result[741] = ciphertext[741] ^ output[37];
result[742] = ciphertext[742] ^ output[38];
result[743] = ciphertext[743] ^ output[39];
result[744] = ciphertext[744] ^ output[40];
result[745] = ciphertext[745] ^ output[41];
result[746] = ciphertext[746] ^ output[42];
result[747] = ciphertext[747] ^ output[43];
result[748] = ciphertext[748] ^ output[44];
result[749] = ciphertext[749] ^ output[45];
result[750] = ciphertext[750] ^ output[46];
result[751] = ciphertext[751] ^ output[47];
result[752] = ciphertext[752] ^ output[48];
result[753] = ciphertext[753] ^ output[49];
result[754] = ciphertext[754] ^ output[50];
result[755] = ciphertext[755] ^ output[51];
result[756] = ciphertext[756] ^ output[52];
result[757] = ciphertext[757] ^ output[53];
result[758] = ciphertext[758] ^ output[54];
result[759] = ciphertext[759] ^ output[55];
result[760] = ciphertext[760] ^ output[56];
result[761] = ciphertext[761] ^ output[57];
result[762] = ciphertext[762] ^ output[58];
result[763] = ciphertext[763] ^ output[59];
result[764] = ciphertext[764] ^ output[60];
result[765] = ciphertext[765] ^ output[61];
result[766] = ciphertext[766] ^ output[62];
result[767] = ciphertext[767] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
result[768] = ciphertext[768] ^ output[0];
result[769] = ciphertext[769] ^ output[1];
result[770] = ciphertext[770] ^ output[2];
result[771] = ciphertext[771] ^ output[3];
result[772] = ciphertext[772] ^ output[4];
result[773] = ciphertext[773] ^ output[5];
result[774] = ciphertext[774] ^ output[6];
result[775] = ciphertext[775] ^ output[7];
result[776] = ciphertext[776] ^ output[8];
result[777] = ciphertext[777] ^ output[9];
result[778] = ciphertext[778] ^ output[10];
result[779] = ciphertext[779] ^ output[11];
result[780] = ciphertext[780] ^ output[12];
result[781] = ciphertext[781] ^ output[13];
result[782] = ciphertext[782] ^ output[14];
result[783] = ciphertext[783] ^ output[15];
result[784] = ciphertext[784] ^ output[16];
result[785] = ciphertext[785] ^ output[17];
result[786] = ciphertext[786] ^ output[18];
result[787] = ciphertext[787] ^ output[19];
result[788] = ciphertext[788] ^ output[20];
result[789] = ciphertext[789] ^ output[21];
result[790] = ciphertext[790] ^ output[22];
result[791] = ciphertext[791] ^ output[23];
result[792] = ciphertext[792] ^ output[24];
result[793] = ciphertext[793] ^ output[25];
result[794] = ciphertext[794] ^ output[26];
result[795] = ciphertext[795] ^ output[27];
result[796] = ciphertext[796] ^ output[28];
result[797] = ciphertext[797] ^ output[29];
result[798] = ciphertext[798] ^ output[30];
result[799] = ciphertext[799] ^ output[31];
result[800] = ciphertext[800] ^ output[32];
result[801] = ciphertext[801] ^ output[33];
result[802] = ciphertext[802] ^ output[34];
result[803] = ciphertext[803] ^ output[35];
result[804] = ciphertext[804] ^ output[36];
result[805] = ciphertext[805] ^ output[37];
result[806] = ciphertext[806] ^ output[38];
result[807] = ciphertext[807] ^ output[39];
result[808] = ciphertext[808] ^ output[40];
result[809] = ciphertext[809] ^ output[41];
result[810] = ciphertext[810] ^ output[42];
result[811] = ciphertext[811] ^ output[43];
result[812] = ciphertext[812] ^ output[44];
result[813] = ciphertext[813] ^ output[45];
result[814] = ciphertext[814] ^ output[46];
result[815] = ciphertext[815] ^ output[47];
result[816] = ciphertext[816] ^ output[48];
result[817] = ciphertext[817] ^ output[49];
result[818] = ciphertext[818] ^ output[50];
result[819] = ciphertext[819] ^ output[51];
result[820] = ciphertext[820] ^ output[52];
result[821] = ciphertext[821] ^ output[53];
result[822] = ciphertext[822] ^ output[54];
result[823] = ciphertext[823] ^ output[55];
result[824] = ciphertext[824] ^ output[56];
result[825] = ciphertext[825] ^ output[57];
result[826] = ciphertext[826] ^ output[58];
result[827] = ciphertext[827] ^ output[59];
result[828] = ciphertext[828] ^ output[60];
result[829] = ciphertext[829] ^ output[61];
result[830] = ciphertext[830] ^ output[62];
result[831] = ciphertext[831] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
result[832] = ciphertext[832] ^ output[0];
result[833] = ciphertext[833] ^ output[1];
result[834] = ciphertext[834] ^ output[2];
result[835] = ciphertext[835] ^ output[3];
result[836] = ciphertext[836] ^ output[4];
result[837] = ciphertext[837] ^ output[5];
result[838] = ciphertext[838] ^ output[6];
result[839] = ciphertext[839] ^ output[7];
result[840] = ciphertext[840] ^ output[8];
result[841] = ciphertext[841] ^ output[9];
result[842] = ciphertext[842] ^ output[10];
result[843] = ciphertext[843] ^ output[11];
result[844] = ciphertext[844] ^ output[12];
result[845] = ciphertext[845] ^ output[13];
result[846] = ciphertext[846] ^ output[14];
result[847] = ciphertext[847] ^ output[15];
result[848] = ciphertext[848] ^ output[16];
result[849] = ciphertext[849] ^ output[17];
result[850] = ciphertext[850] ^ output[18];
result[851] = ciphertext[851] ^ output[19];
result[852] = ciphertext[852] ^ output[20];
result[853] = ciphertext[853] ^ output[21];
result[854] = ciphertext[854] ^ output[22];
result[855] = ciphertext[855] ^ output[23];
result[856] = ciphertext[856] ^ output[24];
result[857] = ciphertext[857] ^ output[25];
result[858] = ciphertext[858] ^ output[26];
result[859] = ciphertext[859] ^ output[27];
result[860] = ciphertext[860] ^ output[28];
result[861] = ciphertext[861] ^ output[29];
result[862] = ciphertext[862] ^ output[30];
result[863] = ciphertext[863] ^ output[31];
result[864] = ciphertext[864] ^ output[32];
result[865] = ciphertext[865] ^ output[33];
result[866] = ciphertext[866] ^ output[34];
result[867] = ciphertext[867] ^ output[35];
result[868] = ciphertext[868] ^ output[36];
result[869] = ciphertext[869] ^ output[37];
result[870] = ciphertext[870] ^ output[38];
result[871] = ciphertext[871] ^ output[39];
result[872] = ciphertext[872] ^ output[40];
result[873] = ciphertext[873] ^ output[41];
result[874] = ciphertext[874] ^ output[42];
result[875] = ciphertext[875] ^ output[43];
result[876] = ciphertext[876] ^ output[44];
result[877] = ciphertext[877] ^ output[45];
result[878] = ciphertext[878] ^ output[46];
result[879] = ciphertext[879] ^ output[47];
result[880] = ciphertext[880] ^ output[48];
result[881] = ciphertext[881] ^ output[49];
result[882] = ciphertext[882] ^ output[50];
result[883] = ciphertext[883] ^ output[51];
result[884] = ciphertext[884] ^ output[52];
result[885] = ciphertext[885] ^ output[53];
result[886] = ciphertext[886] ^ output[54];
result[887] = ciphertext[887] ^ output[55];
result[888] = ciphertext[888] ^ output[56];
result[889] = ciphertext[889] ^ output[57];
result[890] = ciphertext[890] ^ output[58];
result[891] = ciphertext[891] ^ output[59];
result[892] = ciphertext[892] ^ output[60];
result[893] = ciphertext[893] ^ output[61];
result[894] = ciphertext[894] ^ output[62];
result[895] = ciphertext[895] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
result[896] = ciphertext[896] ^ output[0];
result[897] = ciphertext[897] ^ output[1];
result[898] = ciphertext[898] ^ output[2];
result[899] = ciphertext[899] ^ output[3];
result[900] = ciphertext[900] ^ output[4];
result[901] = ciphertext[901] ^ output[5];
result[902] = ciphertext[902] ^ output[6];
result[903] = ciphertext[903] ^ output[7];
result[904] = ciphertext[904] ^ output[8];
result[905] = ciphertext[905] ^ output[9];
result[906] = ciphertext[906] ^ output[10];
result[907] = ciphertext[907] ^ output[11];
result[908] = ciphertext[908] ^ output[12];
result[909] = ciphertext[909] ^ output[13];
result[910] = ciphertext[910] ^ output[14];
result[911] = ciphertext[911] ^ output[15];
result[912] = ciphertext[912] ^ output[16];
result[913] = ciphertext[913] ^ output[17];
result[914] = ciphertext[914] ^ output[18];
result[915] = ciphertext[915] ^ output[19];
result[916] = ciphertext[916] ^ output[20];
result[917] = ciphertext[917] ^ output[21];
result[918] = ciphertext[918] ^ output[22];
result[919] = ciphertext[919] ^ output[23];
result[920] = ciphertext[920] ^ output[24];
result[921] = ciphertext[921] ^ output[25];
result[922] = ciphertext[922] ^ output[26];
result[923] = ciphertext[923] ^ output[27];
result[924] = ciphertext[924] ^ output[28];
result[925] = ciphertext[925] ^ output[29];
result[926] = ciphertext[926] ^ output[30];
result[927] = ciphertext[927] ^ output[31];
result[928] = ciphertext[928] ^ output[32];
result[929] = ciphertext[929] ^ output[33];
result[930] = ciphertext[930] ^ output[34];
result[931] = ciphertext[931] ^ output[35];
result[932] = ciphertext[932] ^ output[36];
result[933] = ciphertext[933] ^ output[37];
result[934] = ciphertext[934] ^ output[38];
result[935] = ciphertext[935] ^ output[39];
result[936] = ciphertext[936] ^ output[40];
result[937] = ciphertext[937] ^ output[41];
result[938] = ciphertext[938] ^ output[42];
result[939] = ciphertext[939] ^ output[43];
result[940] = ciphertext[940] ^ output[44];
result[941] = ciphertext[941] ^ output[45];
result[942] = ciphertext[942] ^ output[46];
result[943] = ciphertext[943] ^ output[47];
result[944] = ciphertext[944] ^ output[48];
result[945] = ciphertext[945] ^ output[49];
result[946] = ciphertext[946] ^ output[50];
result[947] = ciphertext[947] ^ output[51];
result[948] = ciphertext[948] ^ output[52];
result[949] = ciphertext[949] ^ output[53];
result[950] = ciphertext[950] ^ output[54];
result[951] = ciphertext[951] ^ output[55];
result[952] = ciphertext[952] ^ output[56];
result[953] = ciphertext[953] ^ output[57];
result[954] = ciphertext[954] ^ output[58];
result[955] = ciphertext[955] ^ output[59];
result[956] = ciphertext[956] ^ output[60];
result[957] = ciphertext[957] ^ output[61];
result[958] = ciphertext[958] ^ output[62];
result[959] = ciphertext[959] ^ output[63];
x[0] = ctx.input[0]; 
x[1] = ctx.input[1]; 
x[2] = ctx.input[2]; 
x[3] = ctx.input[3]; 
x[4] = ctx.input[4]; 
x[5] = ctx.input[5]; 
x[6] = ctx.input[6]; 
x[7] = ctx.input[7]; 
x[8] = ctx.input[8]; 
x[9] = ctx.input[9]; 
x[10] = ctx.input[10]; 
x[11] = ctx.input[11]; 
x[12] = ctx.input[12]; 
x[13] = ctx.input[13]; 
x[14] = ctx.input[14]; 
x[15] = ctx.input[15]; 
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
QUARTERROUND( 0, 4, 8,12);
QUARTERROUND( 1, 5, 9,13);
QUARTERROUND( 2, 6,10,14);
QUARTERROUND( 3, 7,11,15);
QUARTERROUND( 0, 5,10,15);
QUARTERROUND( 1, 6,11,12);
QUARTERROUND( 2, 7, 8,13);
QUARTERROUND( 3, 4, 9,14);
x[0] = PLUS(x[0],ctx.input[0]); 
x[1] = PLUS(x[1],ctx.input[1]); 
x[2] = PLUS(x[2],ctx.input[2]); 
x[3] = PLUS(x[3],ctx.input[3]); 
x[4] = PLUS(x[4],ctx.input[4]); 
x[5] = PLUS(x[5],ctx.input[5]); 
x[6] = PLUS(x[6],ctx.input[6]); 
x[7] = PLUS(x[7],ctx.input[7]); 
x[8] = PLUS(x[8],ctx.input[8]); 
x[9] = PLUS(x[9],ctx.input[9]); 
x[10] = PLUS(x[10],ctx.input[10]); 
x[11] = PLUS(x[11],ctx.input[11]); 
x[12] = PLUS(x[12],ctx.input[12]); 
x[13] = PLUS(x[13],ctx.input[13]); 
x[14] = PLUS(x[14],ctx.input[14]); 
x[15] = PLUS(x[15],ctx.input[15]); 
U32TO8_LITTLE(output + 4 * 0,x[0]); 
U32TO8_LITTLE(output + 4 * 1,x[1]); 
U32TO8_LITTLE(output + 4 * 2,x[2]); 
U32TO8_LITTLE(output + 4 * 3,x[3]); 
U32TO8_LITTLE(output + 4 * 4,x[4]); 
U32TO8_LITTLE(output + 4 * 5,x[5]); 
U32TO8_LITTLE(output + 4 * 6,x[6]); 
U32TO8_LITTLE(output + 4 * 7,x[7]); 
U32TO8_LITTLE(output + 4 * 8,x[8]); 
U32TO8_LITTLE(output + 4 * 9,x[9]); 
U32TO8_LITTLE(output + 4 * 10,x[10]); 
U32TO8_LITTLE(output + 4 * 11,x[11]); 
U32TO8_LITTLE(output + 4 * 12,x[12]); 
U32TO8_LITTLE(output + 4 * 13,x[13]); 
U32TO8_LITTLE(output + 4 * 14,x[14]); 
U32TO8_LITTLE(output + 4 * 15,x[15]); 
ctx.input[12] = PLUSONE(ctx.input[12]); 
if (!ctx.input[12]) { 
ctx.input[13] = PLUSONE(ctx.input[13]); 
}
result[960] = ciphertext[960] ^ output[0];
result[961] = ciphertext[961] ^ output[1];
result[962] = ciphertext[962] ^ output[2];
result[963] = ciphertext[963] ^ output[3];
result[964] = ciphertext[964] ^ output[4];
result[965] = ciphertext[965] ^ output[5];
result[966] = ciphertext[966] ^ output[6];
result[967] = ciphertext[967] ^ output[7];
result[968] = ciphertext[968] ^ output[8];
result[969] = ciphertext[969] ^ output[9];
result[970] = ciphertext[970] ^ output[10];
result[971] = ciphertext[971] ^ output[11];
result[972] = ciphertext[972] ^ output[12];
result[973] = ciphertext[973] ^ output[13];
result[974] = ciphertext[974] ^ output[14];
result[975] = ciphertext[975] ^ output[15];
result[976] = ciphertext[976] ^ output[16];
result[977] = ciphertext[977] ^ output[17];
result[978] = ciphertext[978] ^ output[18];
result[979] = ciphertext[979] ^ output[19];
result[980] = ciphertext[980] ^ output[20];
result[981] = ciphertext[981] ^ output[21];
result[982] = ciphertext[982] ^ output[22];
result[983] = ciphertext[983] ^ output[23];
result[984] = ciphertext[984] ^ output[24];
result[985] = ciphertext[985] ^ output[25];
result[986] = ciphertext[986] ^ output[26];
result[987] = ciphertext[987] ^ output[27];
result[988] = ciphertext[988] ^ output[28];
result[989] = ciphertext[989] ^ output[29];
result[990] = ciphertext[990] ^ output[30];
result[991] = ciphertext[991] ^ output[31];
result[992] = ciphertext[992] ^ output[32];
result[993] = ciphertext[993] ^ output[33];
result[994] = ciphertext[994] ^ output[34];
result[995] = ciphertext[995] ^ output[35];
result[996] = ciphertext[996] ^ output[36];
result[997] = ciphertext[997] ^ output[37];
result[998] = ciphertext[998] ^ output[38];
result[999] = ciphertext[999] ^ output[39];
result[1000] = ciphertext[1000] ^ output[40];
result[1001] = ciphertext[1001] ^ output[41];
result[1002] = ciphertext[1002] ^ output[42];
result[1003] = ciphertext[1003] ^ output[43];
result[1004] = ciphertext[1004] ^ output[44];
result[1005] = ciphertext[1005] ^ output[45];
result[1006] = ciphertext[1006] ^ output[46];
result[1007] = ciphertext[1007] ^ output[47];
result[1008] = ciphertext[1008] ^ output[48];
result[1009] = ciphertext[1009] ^ output[49];
result[1010] = ciphertext[1010] ^ output[50];
result[1011] = ciphertext[1011] ^ output[51];
result[1012] = ciphertext[1012] ^ output[52];
result[1013] = ciphertext[1013] ^ output[53];
result[1014] = ciphertext[1014] ^ output[54];
result[1015] = ciphertext[1015] ^ output[55];
result[1016] = ciphertext[1016] ^ output[56];
result[1017] = ciphertext[1017] ^ output[57];
result[1018] = ciphertext[1018] ^ output[58];
result[1019] = ciphertext[1019] ^ output[59];
result[1020] = ciphertext[1020] ^ output[60];
result[1021] = ciphertext[1021] ^ output[61];
result[1022] = ciphertext[1022] ^ output[62];
result[1023] = ciphertext[1023] ^ output[63];


    printf("And now decrypting back: [%s]\n", result);

    return 0;
}

void showData(u8 *data, u8 *header) {
    printf("\n-----BEGIN %s-----\n%s\n-----END %s-----\n\n", header, data, header);

}

//***provided by supervisor. Returns the number of cycles at the current moment.
static inline uint64_t rdtscp64() {
  uint32_t low, high;
  asm volatile ("rdtscp": "=a" (low), "=d" (high) :: "ecx");
  return (((uint64_t)high) << 32) | low;
}
